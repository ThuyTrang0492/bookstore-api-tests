{
	"info": {
		"_postman_id": "318910dd-601e-407d-b7f9-d246e35a4c36",
		"name": "Book Store API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "46176277",
		"_collection_link": "https://winter-crescent-405175.postman.co/workspace/My-Workspace~1bdeaa0c-2bbb-45da-8776-ebfaabf98fae/collection/40754843-318910dd-601e-407d-b7f9-d246e35a4c36?action=share&source=collection_link&creator=46176277"
	},
	"item": [
		{
			"name": "Books",
			"item": [
				{
					"name": "Get all books",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"//  1. KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"‚ùå Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  2. KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let response;\r",
									"let isJsonValid = true;\r",
									"try {\r",
									"    response = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.warn(\" Kh√¥ng parse ƒë∆∞·ª£c JSON:\", e);\r",
									"    pm.environment.set(\"inforMessage\", \" Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá.\");\r",
									"}\r",
									"\r",
									"pm.test(\" Ph·∫£n h·ªìi l√† JSON h·ª£p l·ªá\", () => {\r",
									"    pm.expect(isJsonValid).to.be.true;\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  3. TEST CHUNG CHO STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ===============================\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"\r",
									"pm.test(` Status code l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 401, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\" Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\" Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType.toLowerCase()).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  4. LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"if (statusCode === 200) {\r",
									"    pm.test(\"200 - Th√†nh c√¥ng\", () => {\r",
									"        pm.expect(statusCode).to.eql(200);\r",
									"    });\r",
									"\r",
									"    if (isJsonValid) {\r",
									"        pm.test(\" D·ªØ li·ªáu ph·∫£n h·ªìi l√† m·∫£ng JSON\", () => {\r",
									"            pm.expect(response).to.be.an(\"array\");\r",
									"        });\r",
									"\r",
									"        if (response.length > 0) {\r",
									"            response.forEach((book, index) => {\r",
									"                const requiredFields = [\r",
									"                    \"id\", \"title\", \"author\", \"price\",\r",
									"                    \"category\", \"stock\", \"rating\",\r",
									"                    \"publishedYear\", \"status\"\r",
									"                ];\r",
									"\r",
									"                pm.test(` S√°ch #${index + 1} c√≥ ƒë·ªß tr∆∞·ªùng & ƒë√∫ng ki·ªÉu`, () => {\r",
									"                    pm.expect(book).to.have.all.keys(...requiredFields);\r",
									"                    pm.expect(book.id).to.be.a(\"string\");\r",
									"                    pm.expect(book.title).to.be.a(\"string\");\r",
									"                    pm.expect(book.author).to.be.a(\"string\");\r",
									"                    pm.expect(book.price).to.be.a(\"number\");\r",
									"                    pm.expect(book.category).to.be.a(\"string\");\r",
									"                    pm.expect(book.stock).to.be.a(\"number\");\r",
									"                    pm.expect(book.rating).to.be.a(\"number\");\r",
									"                    pm.expect(book.publishedYear).to.be.a(\"number\");\r",
									"                    pm.expect([\"available\", \"out_of_stock\"]).to.include(book.status);\r",
									"                });\r",
									"            });\r",
									"\r",
									"            pm.environment.set(\"bookId\", response[0].id);\r",
									"            const msg = ` C√≥ s√°ch: ${response.map(b => b.title).join(\", \")}`;\r",
									"            pm.environment.set(\"inforMessage\", msg);\r",
									"        } else {\r",
									"            pm.environment.set(\"inforMessage\", \" Ph·∫£n h·ªìi 200 nh∆∞ng kh√¥ng c√≥ s√°ch n√†o.\");\r",
									"            pm.test(\" M·∫£ng s√°ch r·ªóng\", () => {\r",
									"                pm.expect.fail(\"Ph·∫£n h·ªìi 200 nh∆∞ng kh√¥ng c√≥ d·ªØ li·ªáu s√°ch.\");\r",
									"            });\r",
									"        }\r",
									"    } else {\r",
									"        pm.test(\"‚ùå Kh√¥ng parse ƒë∆∞·ª£c JSON\", () => {\r",
									"            pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá.\");\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  5. X·ª¨ L√ù TR·∫†NG TH√ÅI KH√ÅC\r",
									"// ===============================\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\" 400 - Y√™u c·∫ßu kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"    });\r",
									"    const msg = isJsonValid && response.message\r",
									"        ? response.message\r",
									"        : \" L·ªói 400: Kh√¥ng r√µ l√Ω do.\";\r",
									"    pm.environment.set(\"inforMessage\", msg);\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\" 401 - Kh√¥ng c√≥ quy·ªÅn ho·∫∑c ch∆∞a x√°c th·ª±c\", () => {\r",
									"        pm.expect(statusCode).to.eql(401);\r",
									"    });\r",
									"    const msg = isJsonValid && response.message\r",
									"        ? response.message\r",
									"        : \" L·ªói 401: Kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c.\";\r",
									"    pm.environment.set(\"inforMessage\", msg);\r",
									"}\r",
									"\r",
									"if (statusCode === 404) {\r",
									"    pm.test(\" 404 - Kh√¥ng t√¨m th·∫•y t√†i nguy√™n\", () => {\r",
									"        pm.expect(statusCode).to.eql(404);\r",
									"    });\r",
									"\r",
									"    if (!isJsonValid || !response || typeof response !== 'object') {\r",
									"        pm.test(\"‚ùå Ph·∫£n h·ªìi 404 nh∆∞ng kh√¥ng ph·∫£i JSON h·ª£p l·ªá\", () => {\r",
									"            pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng ph·∫£i JSON.\");\r",
									"        });\r",
									"        pm.environment.set(\"inforMessage\", \"‚ùå Ph·∫£n h·ªìi kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng parse ƒë∆∞·ª£c.\");\r",
									"    } else if (!response.message || response.message.trim() === \"\") {\r",
									"        pm.test(\"‚ùå 404 tr·∫£ v·ªÅ nh∆∞ng kh√¥ng c√≥ th√¥ng b√°o l·ªói (message)\", () => {\r",
									"            pm.expect.fail(\"API tr·∫£ v·ªÅ 404 nh∆∞ng kh√¥ng c√≥ n·ªôi dung message ƒë·ªÉ gi·∫£i th√≠ch.\");\r",
									"        });\r",
									"        pm.environment.set(\"inforMessage\", \"‚ùå Thi·∫øu message trong ph·∫£n h·ªìi 404.\");\r",
									"    } else {\r",
									"        pm.test(\" Ph·∫£n h·ªìi 404 c√≥ message m√¥ t·∫£\", () => {\r",
									"            pm.expect(response).to.have.property(\"message\");\r",
									"            pm.expect(response.message.length).to.be.greaterThan(0);\r",
									"        });\r",
									"        pm.environment.set(\"inforMessage\", response.message);\r",
									"    }\r",
									"}\r",
									"\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(statusCode).to.eql(500);\r",
									"    });\r",
									"    pm.environment.set(\"inforMessage\", \" L·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù STATUS CODE KH√îNG MONG ƒê·ª¢I\r",
									"// ===============================\r",
									"if (![200, 400, 401, 404, 500].includes(statusCode)) {\r",
									"    pm.test(\" Status code kh√¥ng n·∫±m trong danh s√°ch mong ƒë·ª£i\", () => {\r",
									"        pm.expect.fail(`Status code kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω: ${statusCode}`);\r",
									"    });\r",
									"    pm.environment.set(\"inforMessage\", ` M√£ ph·∫£n h·ªìi kh√¥ng n·∫±m trong danh s√°ch x·ª≠ l√Ω: ${statusCode}`);\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"//pm.environment.set(\"admin_token\",\"fake-admin-token-9\");\r",
									"//pm.environment.set(\"admin_token\",\"fake-admin-token-999\");\r",
									"\r",
									"\r",
									"//pm.environment.set(\"user_token\",\"fake-user-token-9\");\r",
									"//pm.environment.set(\"user_token\",\"fake-user-token-999\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{base_url}}/books",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books"
							]
						},
						"description": "Truy xu·∫•t to√†n b·ªô danh s√°ch c√°c cu·ªën s√°ch hi·ªán c√≥ trong h·ªá th·ªëng.  \nƒê√¢y l√† ch·ª©c nƒÉng ‚ÄúRead‚Äù trong m√¥ h√¨nh CRUD (Create - Read - Update - Delete).  \nS·ª≠ d·ª•ng ƒë·ªÉ ki·ªÉm tra d·ªØ li·ªáu hi·ªán t·∫°i ho·∫∑c sau khi th·ª±c hi·ªán c√°c thao t√°c th√™m/xo√°/s·ª≠a."
					},
					"response": []
				},
				{
					"name": "Get book by ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"\r",
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"//  1. KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"‚ùå Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"// === Parse JSON an to√†n ===\r",
									"let response;\r",
									"let isJsonValid = true;\r",
									"try {\r",
									"    response = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.warn(\"‚ùå Kh√¥ng parse ƒë∆∞·ª£c JSON:\", e);\r",
									"    pm.environment.set(\"inforMessage\", \"‚ùå Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá.\");\r",
									"}\r",
									"\r",
									"// === L·∫•y status code v√† bookId ƒëang test ===\r",
									"\r",
									"const bookId = pm.environment.get(\"bookId\");\r",
									"console.log(\" bookId ƒëang test:\", bookId);\r",
									"\r",
									"// === Ki·ªÉm tra status code n·∫±m trong danh s√°ch h·ª£p l·ªá ===\r",
									"pm.test(` Status code l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"// === Ki·ªÉm tra JSON h·ª£p l·ªá n·∫øu c√≥ ===\r",
									"if (isJsonValid) {\r",
									"    pm.test(\" Ph·∫£n h·ªìi l√† JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect(response).to.be.an(\"object\");\r",
									"    });\r",
									"\r",
									"    // Ch·ªâ test 'message' n·∫øu KH√îNG ph·∫£i 200\r",
									"    if (statusCode !== 200) {\r",
									"        pm.test(\" Ph·∫£n h·ªìi c√≥ tr∆∞·ªùng 'message'\", () => {\r",
									"            pm.expect(response).to.have.property(\"message\");\r",
									"            pm.expect(response.message).to.be.a(\"string\").and.not.empty;\r",
									"        });\r",
									"    }\r",
									"} else {\r",
									"    pm.test(\"‚ùå Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON\", () => {\r",
									"        pm.expect.fail(\"Kh√¥ng th·ªÉ parse JSON t·ª´ ph·∫£n h·ªìi\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// === Ph√¢n nh√°nh x·ª≠ l√Ω theo status code ===\r",
									"switch (statusCode) {\r",
									"    case 200:\r",
									"        pm.test(\" 200 - Th√†nh c√¥ng\", () => {\r",
									"            pm.expect(statusCode).to.eql(200);\r",
									"        });\r",
									"\r",
									"        if (isJsonValid) {\r",
									"            const book = response;\r",
									"            const expectedKeys = [\r",
									"                \"id\", \"title\", \"author\", \"price\", \"category\",\r",
									"                \"stock\", \"rating\", \"publishedYear\", \"status\"\r",
									"            ];\r",
									"\r",
									"            pm.test(\" Book c√≥ ƒë·ªß tr∆∞·ªùng\", () => {\r",
									"                pm.expect(book).to.have.all.keys(...expectedKeys);\r",
									"            });\r",
									"\r",
									"            pm.test(\" Book c√≥ ki·ªÉu d·ªØ li·ªáu ƒë√∫ng\", () => {\r",
									"                const type = typeof book.id;\r",
									"                pm.expect([\"string\", \"number\"]).to.include(type);\r",
									"                pm.expect(book.title).to.be.a(\"string\");\r",
									"                pm.expect(book.author).to.be.a(\"string\");\r",
									"                pm.expect(book.price).to.be.a(\"number\");\r",
									"                pm.expect(book.category).to.be.a(\"string\");\r",
									"                pm.expect(book.stock).to.be.a(\"number\");\r",
									"                pm.expect(book.rating).to.be.a(\"number\");\r",
									"                pm.expect(book.publishedYear).to.be.a(\"number\");\r",
									"                pm.expect([\"available\", \"out_of_stock\"]).to.include(book.status);\r",
									"            });\r",
									"\r",
									"            // L∆∞u l·∫°i th√¥ng tin\r",
									"            pm.environment.set(\"bookId\", book.id);\r",
									"            pm.environment.set(\"inforMessage\", ` Book: ${book.title}`);\r",
									"        }\r",
									"        break;\r",
									"\r",
									"    case 404:\r",
									"        pm.test(\"‚ùå 404 - C√≥ message l·ªói h·ª£p l·ªá\", () => {\r",
									"            pm.expect(response.message).to.be.a(\"string\").and.not.empty;\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 401:\r",
									"        pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"            pm.expect(true).to.be.true; // Test n√†y lu√¥n pass, d√πng ƒë·ªÉ hi·ªÉn th·ªã c·∫£nh b√°o b√™n d∆∞·ªõi\r",
									"            console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"        });\r",
									"\r",
									"        pm.test(\"401 - Message ch·ª©a m√£ l·ªói ho·∫∑c th√¥ng tin x√°c th·ª±c\", () => {\r",
									"            pm.expect(response.message).to.match(/401|unauthorized|ch∆∞a x√°c th·ª±c|kh√¥ng c√≥ quy·ªÅn/i);\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 403:\r",
									"        pm.test(\" 403 - Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p\", () => {\r",
									"            pm.expect(response.message).to.include(\"403\");\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 400:\r",
									"        pm.test(\"üö´ 400 - D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect(response.message).to.be.a(\"string\").and.not.empty;\r",
									"        });\r",
									"    break;\r",
									"\r",
									"    case 500:\r",
									"        pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"            pm.expect(response.message || \"\").to.include(\"l·ªói\");\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    default:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i ch∆∞a ƒë∆∞·ª£c x·ª≠ l√Ω\", () => {\r",
									"            pm.expect.fail(`Kh√¥ng x·ª≠ l√Ω ƒë∆∞·ª£c status code: ${statusCode}`);\r",
									"        });\r",
									"}\r",
									"\r",
									"// === Ki·ªÉm tra th·ªùi gian ph·∫£n h·ªìi ===\r",
									"pm.test(\" Ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra bookId ƒë√∫ng\r",
									" pm.environment.set(\"bookId\", \"1\"); \r",
									"// //Ki·ªÉm tra bookId null\r",
									"// pm.environment.set(\"bookId\", \"null\"); \r",
									"// //Ki·ªÉm tra bookId r·ªóng\r",
									" //pm.environment.set(\"bookId\", \"\"); \r",
									"// //Ki·ªÉm tra bookId sai ƒë·ªãnh d·∫°ng\r",
									"//pm.environment.set(\"bookId\", \"abc\"); \r",
									"// //Ki·ªÉm tra bookId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookId\", \"@\"); \r",
									"// //Ki·ªÉm tra bookId kh√¥ng t·ªìn t·∫°i\r",
									" //pm.environment.set(\"bookId\", \"999\"); \r",
									"// //Ki·ªÉm tra bookId s·ªë √¢m\r",
									" //pm.environment.set(\"bookId\", \"-1\"); "
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{base_url}}/books/{{bookId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books",
								"{{bookId}}"
							]
						},
						"description": "L·∫•y th√¥ng tin chi ti·∫øt c·ªßa m·ªôt cu·ªën s√°ch d·ª±a v√†o id.  \nS·ª≠ d·ª•ng khi c·∫ßn xem ho·∫∑c ki·ªÉm tra d·ªØ li·ªáu c·ª• th·ªÉ.  \nN·∫øu ID kh√¥ng t·ªìn t·∫°i, API s·∫Ω tr·∫£ v·ªÅ 404."
					},
					"response": []
				},
				{
					"name": "Create new book",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"//BI·∫æN D√ôNG CHUNG\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"const currentYear = new Date().getFullYear();\r",
									"const testingDuplicateTitle = pm.environment.get(\"testingDuplicateTitle\") === \"true\";\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let response;\r",
									"let isJsonValid = true;\r",
									"\r",
									"try {\r",
									"    response = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.error(\"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá:\", e);\r",
									"    pm.environment.set(\"inforMessage\", \"JSON kh√¥ng h·ª£p l·ªá\");\r",
									"}\r",
									"const msg = (isJsonValid && typeof response === 'object')\r",
									"    ? (response.message || response.error || \"\").toString().trim().toLowerCase()\r",
									"    : \"\";\r",
									"\r",
									"if (isJsonValid) {\r",
									"    pm.test(\" Ph·∫£n h·ªìi l√† JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect(response).to.be.an(\"object\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG: status, time, content-type\r",
									"// ===============================\r",
									"pm.test(\" Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"pm.test(` Status code l√† ${statusCode}`, () => {\r",
									"    pm.expect([201, 400, 401, 403,404, 409, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\" Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù D·ªÆ LI·ªÜU G·ª¨I L√äN\r",
									"// ===============================\r",
									"let requestBody = {};\r",
									"try {\r",
									"    requestBody = JSON.parse(pm.request.body.raw || \"{}\");\r",
									"} catch (e) {\r",
									"    console.warn(\" Kh√¥ng parse ƒë∆∞·ª£c body g·ª≠i l√™n:\", e);\r",
									"}\r",
									"\r",
									"function isRequestValid(data) {\r",
									"    return (\r",
									"        data.title && data.title.trim() !== \"\" &&\r",
									"        data.author && data.author.trim() !== \"\" &&\r",
									"        typeof data.price === \"number\" && data.price >= 0 &&\r",
									"        typeof data.stock === \"number\" && data.stock >= 0 &&\r",
									"        typeof data.rating === \"number\" && data.rating >= 1 && data.rating <= 5 &&\r",
									"        typeof data.publishedYear === \"number\" && data.publishedYear <= currentYear &&\r",
									"        typeof data.category === \"string\" && data.category.trim() !== \"\" &&\r",
									"        [\"available\", \"out_of_stock\"].includes((data.status || \"\").toLowerCase())\r",
									"    );\r",
									"}\r",
									"\r",
									"const inputIsValid = isRequestValid(requestBody);\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù KHI STATUS = 201\r",
									"// ===============================\r",
									"if (statusCode === 201) {\r",
									"    if (!inputIsValid) {\r",
									"        pm.test(\"‚ùå Kh√¥ng n√™n tr·∫£ v·ªÅ 201 v·ªõi d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect.fail(\"D·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá nh∆∞ng server v·∫´n tr·∫£ v·ªÅ 201 Created.\");\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (testingDuplicateTitle) {\r",
									"        pm.test(\"‚ùå Kh√¥ng n√™n tr·∫£ v·ªÅ 201 n·∫øu title b·ªã tr√πng\", () => {\r",
									"            pm.expect.fail(\"Title b·ªã tr√πng nh∆∞ng server v·∫´n tr·∫£ v·ªÅ 201. C·∫ßn x·ª≠ l√Ω tr·∫£ v·ªÅ 409.\");\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (inputIsValid && !testingDuplicateTitle) {\r",
									"        pm.environment.set(\"bookId\", response.id || \"\");\r",
									"\r",
									"        const requiredFields = [\r",
									"            \"id\", \"title\", \"author\", \"price\", \"category\",\r",
									"            \"stock\", \"rating\", \"publishedYear\", \"status\"\r",
									"        ];\r",
									"\r",
									"        pm.test(\" C√≥ ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng d·ªØ li·ªáu\", () => {\r",
									"            pm.expect(response).to.have.all.keys(...requiredFields);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ki·ªÉu d·ªØ li·ªáu ƒë√∫ng v√† h·ª£p l·ªá\", () => {\r",
									"            pm.expect(response.id).to.be.a(\"string\");\r",
									"            pm.expect(response.title).to.be.a(\"string\");\r",
									"            pm.expect(response.author).to.be.a(\"string\");\r",
									"            pm.expect(response.price).to.be.a(\"number\").and.at.least(0);\r",
									"            pm.expect(response.category).to.be.a(\"string\");\r",
									"            pm.expect(response.stock).to.be.a(\"number\").and.at.least(0);\r",
									"            pm.expect(response.rating).to.be.a(\"number\").and.within(1, 5);\r",
									"            pm.expect(response.publishedYear).to.be.a(\"number\").and.at.most(currentYear);\r",
									"            pm.expect([\"available\", \"out_of_stock\"]).to.include(response.status.toLowerCase());\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//   X·ª¨ L√ù L·ªñI: 400, 409, 403, 401, 500\r",
									"// ===============================\r",
									"if ([400, 409].includes(statusCode)) {\r",
									"    const msg = (response.message || response.error || \"\").toLowerCase().trim();\r",
									"\r",
									"    pm.test(\" C√≥ th√¥ng b√°o l·ªói ph√π h·ª£p\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"        pm.expect(msg).to.match(/title|author|missing|required|thi·∫øu|b·∫Øt bu·ªôc|blank|empty|tr√πng|duplicate|price|stock|rating|published\\s?year|nƒÉm xu·∫•t b·∫£n|status|kho·∫£ng tr·∫Øng|ch·ªâ ch·ª©a kho·∫£ng tr·∫Øng/i);\r",
									"    });\r",
									"\r",
									"    if (msg.includes(\"status\") && msg.match(/invalid|kh√¥ng h·ª£p l·ªá/i)) {\r",
									"        pm.test(\" 'status' ch·ªâ ƒë∆∞·ª£c ph√©p l√† 'available' ho·∫∑c 'out_of_stock'\", () => {\r",
									"            pm.expect(msg).to.match(/available|out_of_stock/i);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\" 401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\" C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 403) {\r",
									"    const msg = (response.message || \"\").toLowerCase().trim();\r",
									"    pm.test(\"Ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn t·∫°o s√°ch\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 404) {\r",
									"    const msg = (response?.message || response?.error || \"\").trim();\r",
									"\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y t√†i nguy√™n\", () => {\r",
									"        pm.expect(statusCode).to.eql(404);\r",
									"    });\r",
									"\r",
									"    pm.test(\" Ph·∫£n h·ªìi 404 ph·∫£i c√≥ message\", () => {\r",
									"        pm.expect(msg.length).to.be.greaterThan(0, \"Ph·∫£n h·ªìi 404 thi·∫øu message m√¥ t·∫£.\");\r",
									"        pm.expect(msg.toLowerCase()).to.match(/not\\s?found|kh√¥ng t√¨m th·∫•y|not exist|invalid/i);\r",
									"    });\r",
									"\r",
									"    // C·∫£nh b√°o n·∫øu URL c√≥ v·∫ª sai m√† l·∫°i tr·∫£ v·ªÅ 200\r",
									"    const requestUrl = pm.request.url.toString();\r",
									"    const looksLikeInvalidPath = /(invalid|fake|wrong|notfound|nonexistent|404|sai)/i.test(requestUrl);\r",
									"    if (!looksLikeInvalidPath) {\r",
									"        console.warn(\"  ƒê∆∞·ªùng d·∫´n kh√¥ng r√µ l√† sai, b·∫°n n√™n ki·ªÉm tra th·ªß c√¥ng.\");\r",
									"    }\r",
									"}\r",
									"\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\" C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra t·∫°o s√°ch m·ªõi v·ªõi title tr√πng\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Tr·ªü l·∫°i\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 70000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 6,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// pm.environment.set(\"testingDuplicateTitle\", \"true\"); \r",
									"// // Ki·ªÉm tra t·∫°o s√°ch m·ªõi th√†nh c√¥ng\r",
									"pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"    title: \"NƒÉm Th√°ng R·ª±c R·ª°\",\r",
									"    author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"    price: 70000,\r",
									"    category: \"ƒê·ªùi S·ªëng\",\r",
									"    stock: 5,\r",
									"    rating: 4.5,\r",
									"    publishedYear: 2025,\r",
									"    status: \"available\"\r",
									"}));\r",
									"// //Ki·ªÉm tra S√°ch thi·∫øu tr∆∞·ªùng title,author,price,category,stock,rating,publishedYear,status\r",
									"//  pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng title r·ªóng\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra title l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: null,\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra title c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"1234567890\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng author r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra author l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: null,\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra author c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"1234567890\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra author c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"@\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng price r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"\",\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra price l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: null,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra price c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"abc\",\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra price c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"abc\",\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra price l√† s·ªë √¢m\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"-60000\",\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng category r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Aii\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra category l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: null,\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra category c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"60000\",\r",
									"//     category: \"123\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra category c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: \"60000\",\r",
									"//     category: \"@\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng stock r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: \"\",\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra stock l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: null,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra stock c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: \"abc\",\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"//Ki·ªÉm tra stock c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: \"@\",\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// Ki·ªÉm tra stock l√† s·ªë √¢m\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: \"-6\",\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng rating r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: \"\",\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra rating l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: null,\r",
									"//     publishedYear: 2025,\r",
									"//     status:\"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating c√≥ ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: \"abc\",\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: \"@\",\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating nh·ªè h∆°n 1\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 0,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating l·ªõn h∆°n 5\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 6,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"//Ki·ªÉm tra rating l√† s·ªë √¢m\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: -5,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng publishedYear r·ªóng \r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating:4,\r",
									"//     publishedYear: \"\",\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra publishedYear l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: null,\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra publishedYear c√≥ ƒëinh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: \"abc\",\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra publishedYear c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: \"@\",\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra publishedYear l·ªõn h∆°n nƒÉm hi·ªán t·∫°i\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: \"9999\",\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra publishedYear l√† s·ªë √¢m\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: \"-2025\",\r",
									"//     status: \"available\"\r",
									"// }));\r",
									"\r",
									"\r",
									"// //Ki·ªÉm tra S√°ch tr∆∞·ªùng status r·ªóng\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra status l√† null\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: null\r",
									"// }));   \r",
									"// //Ki·ªÉm tra status c√≥ ƒëinh d·∫°ng sai\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"123\"\r",
									"// })); \r",
									"// // Ki·ªÉm tra status ch·ªâ thu·ªôc hai tr∆∞·ªùng available v√† out_of_stock\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"avai\"\r",
									"// })); \r",
									"// // Ki·ªÉm tra status c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookBody\", JSON.stringify({\r",
									"//     title: \"Thanh Xu√¢n ƒê√≥ C√≥ Ai\",\r",
									"//     author: \"Nguy·ªÖn Th·ªã Th√πy Trang\",\r",
									"//     price: 60000,\r",
									"//     category: \"ƒê·ªùi S·ªëng\",\r",
									"//     stock: 5,\r",
									"//     rating: 4,\r",
									"//     publishedYear: 2025,\r",
									"//     status: \"@\"\r",
									"// })); \r",
									"\r",
									"\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"strictSSL": true,
						"insecureHTTPParser": false,
						"removeRefererHeaderOnRedirect": true,
						"followAuthorizationHeader": true,
						"followOriginalHttpMethod": true,
						"disableCookies": true,
						"tlsPreferServerCiphers": true
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{bookBody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/books",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books"
							]
						},
						"description": "G·ª≠i y√™u c·∫ßu ƒë·ªÉ th√™m m·ªôt cu·ªën s√°ch m·ªõi v√†o danh s√°ch.  \nƒê√¢y l√† thao t√°c ‚ÄúCreate‚Äù trong m√¥ h√¨nh CRUD.  \nTr∆∞·ªùng id s·∫Ω ƒë∆∞·ª£c t·ª± ƒë·ªông t·∫°o b·ªüi json-sever."
					},
					"response": []
				},
				{
					"name": "Update book",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\"fake-admin-token-999\", \"fake-user-token-123\"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  PARSE PH·∫¢N H·ªíI JSON AN TO√ÄN\r",
									"// ===============================\r",
									"let response;\r",
									"let isJsonValid = true;\r",
									"\r",
									"try {\r",
									"    response = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.error(\"JSON kh√¥ng h·ª£p l·ªá:\", e);\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG\r",
									"// ===============================\r",
									"pm.test(`Status code l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 409, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  PH√ÇN T√çCH REQUEST BODY G·ª¨I L√äN\r",
									"// ===============================\r",
									"const requestBody = pm.request.body.raw ? JSON.parse(pm.request.body.raw) : {};\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"if (isJsonValid && typeof response === \"object\" && statusCode === 200) {\r",
									"    pm.test(\"C·∫≠p nh·∫≠t th√†nh c√¥ng (200 OK)\", () => {\r",
									"        pm.expect(response).to.have.property(\"id\");\r",
									"    });\r",
									"\r",
									"    pm.environment.set(\"bookId\", response.id);\r",
									"\r",
									"    const requiredFields = [\r",
									"        \"id\", \"title\", \"author\", \"price\", \"category\",\r",
									"        \"stock\", \"rating\", \"publishedYear\", \"status\"\r",
									"    ];\r",
									"\r",
									"    requiredFields.forEach(field => {\r",
									"        pm.test(`C√≥ tr∆∞·ªùng '${field}'`, () => {\r",
									"            pm.expect(response).to.have.property(field);\r",
									"        });\r",
									"    });\r",
									"\r",
									"    const fieldTypes = {\r",
									"        id: 'string',\r",
									"        title: 'string',\r",
									"        author: 'string',\r",
									"        price: 'number',\r",
									"        category: 'string',\r",
									"        stock: 'number',\r",
									"        rating: 'number',\r",
									"        publishedYear: 'number',\r",
									"        status: 'string'\r",
									"    };\r",
									"\r",
									"    Object.entries(fieldTypes).forEach(([field, type]) => {\r",
									"        pm.test(`Ki·ªÉu '${field}' l√† ${type}`, () => {\r",
									"            pm.expect(response[field]).to.be.a(type);\r",
									"        });\r",
									"    });\r",
									"\r",
									"    pm.test(\"Gi√° kh√¥ng √¢m\", () => {\r",
									"        pm.expect(response.price).to.be.at.least(0);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Stock kh√¥ng √¢m\", () => {\r",
									"        pm.expect(response.stock).to.be.at.least(0);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Rating t·ª´ 1 ƒë·∫øn 5\", () => {\r",
									"        pm.expect(response.rating).to.be.within(1, 5);\r",
									"    });\r",
									"\r",
									"    pm.test(\"NƒÉm xu·∫•t b·∫£n kh√¥ng l·ªõn h∆°n hi·ªán t·∫°i\", () => {\r",
									"        pm.expect(response.publishedYear).to.be.at.most(new Date().getFullYear());\r",
									"    });\r",
									"\r",
									"    pm.test(\"ID kh√¥ng b·ªã thay ƒë·ªïi n·∫øu c√≥ g·ª≠i\", () => {\r",
									"        if (requestBody.id) {\r",
									"            pm.expect(response.id).not.eql(requestBody.id);\r",
									"        }\r",
									"    });\r",
									"\r",
									"    // ‚úÖ B·ªï sung ch√≠nh x√°c logic ki·ªÉm tra c·∫≠p nh·∫≠t tr√πng d·ªØ li·ªáu\r",
									"    pm.test(\"‚ùå Kh√¥ng n√™n tr·∫£ v·ªÅ 200 n·∫øu d·ªØ li·ªáu kh√¥ng thay ƒë·ªïi\", () => {\r",
									"        let isSame = true;\r",
									"        for (const key in requestBody) {\r",
									"            if (key !== \"id\" && response[key] !== undefined) {\r",
									"                if (JSON.stringify(requestBody[key]) !== JSON.stringify(response[key])) {\r",
									"                    isSame = false;\r",
									"                    break;\r",
									"                }\r",
									"            }\r",
									"        }\r",
									"\r",
									"        if (isSame) {\r",
									"            pm.expect.fail(\"D·ªØ li·ªáu g·ª≠i l√™n kh√¥ng kh√°c g√¨ so v·ªõi tr∆∞·ªõc, nh∆∞ng server v·∫´n tr·∫£ v·ªÅ 200.\");\r",
									"        }\r",
									"    });\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù C√ÅC L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"if (isJsonValid && typeof response === \"object\") {\r",
									"    const msg = (response.message || \"\").toLowerCase().trim();\r",
									"\r",
									"    if ([400, 409].includes(statusCode)) {\r",
									"        pm.test(\" L·ªói 400/409 ph·∫£i c√≥ th√¥ng b√°o l·ªói r√µ r√†ng\", () => {\r",
									"            if (!msg) pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng c√≥ message.\");\r",
									"        });\r",
									"\r",
									"        if (/title/i.test(msg) && /(exists|duplicate|tr√πng)/i.test(msg)) {\r",
									"            pm.test(\" C√≥ l·ªói: ti√™u ƒë·ªÅ b·ªã tr√πng\", () => {\r",
									"                pm.expect(true).to.be.true;\r",
									"            });\r",
									"        } else {\r",
									"            pm.test(\"‚ùå N·∫øu ƒëang test l·ªói tr√πng title m√† kh√¥ng th·∫•y c·∫£nh b√°o\", () => {\r",
									"                if (requestBody.title) {\r",
									"                    pm.expect.fail(\"Kh√¥ng th·∫•y th√¥ng b√°o title b·ªã tr√πng.\");\r",
									"                }\r",
									"            });\r",
									"        }\r",
									"\r",
									"        if (/missing|required|thi·∫øu|blank|kho·∫£ng tr·∫Øng|ch·ªâ ch·ª©a kho·∫£ng tr·∫Øng/i.test(msg)) {\r",
									"            pm.test(\" C√≥ l·ªói: thi·∫øu tr∆∞·ªùng ho·∫∑c ch·ªâ ch·ª©a kho·∫£ng tr·∫Øng\", () => {\r",
									"                pm.expect(true).to.be.true;\r",
									"            });\r",
									"        } else if (Object.values(requestBody).some(v => typeof v === \"string\" && v.trim() === \"\")) {\r",
									"            pm.test(\"‚ùå Kh√¥ng ph√°t hi·ªán gi√° tr·ªã r·ªóng/blank\", () => {\r",
									"                pm.expect.fail(\"Request c√≥ gi√° tr·ªã blank nh∆∞ng server kh√¥ng tr·∫£ l·ªói.\");\r",
									"            });\r",
									"        }\r",
									"\r",
									"        if (/price|stock|rating|publishedyear|status|nƒÉm xu·∫•t b·∫£n/i.test(msg)) {\r",
									"            pm.test(\" C√≥ l·ªói: sai ki·ªÉu d·ªØ li·ªáu ho·∫∑c gi√° tr·ªã kh√¥ng h·ª£p l·ªá\", () => {\r",
									"                pm.expect(true).to.be.true;\r",
									"            });\r",
									"        }\r",
									"    }\r",
									"\r",
									"    if (statusCode === 403) {\r",
									"        pm.test(\"‚ùå 403 - Ph·∫£i th√¥ng b√°o kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"            if (!msg.includes(\"kh√¥ng c√≥ quy·ªÅn\")) {\r",
									"                pm.expect.fail(\"403 tr·∫£ v·ªÅ nh∆∞ng kh√¥ng th√¥ng b√°o r√µ r√†ng v·ªÅ quy·ªÅn truy c·∫≠p.\");\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\" Kh√¥ng ph·∫£i l·ªói x√°c th·ª±c (401)\", () => {\r",
									"            pm.expect(msg.includes(\"kh√¥ng x√°c th·ª±c\")).to.be.false;\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (statusCode === 401) {\r",
									"        pm.test(\"‚ùå 401 - Ph·∫£i c√≥ th√¥ng b√°o x√°c th·ª±c\", () => {\r",
									"            if (!msg.includes(\"kh√¥ng x√°c th·ª±c\") && !msg.includes(\"unauthorized\")) {\r",
									"                pm.expect.fail(\"401 tr·∫£ v·ªÅ nh∆∞ng kh√¥ng c√≥ th√¥ng b√°o x√°c th·ª±c.\");\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (statusCode === 404) {\r",
									"        pm.test(\"‚ùå 404 - Ph·∫£i c√≥ message kh√¥ng t√¨m th·∫•y\", () => {\r",
									"            if (!msg.includes(\"kh√¥ng t·ªìn t·∫°i\") && !msg.includes(\"not found\")) {\r",
									"                pm.expect.fail(\"404 tr·∫£ v·ªÅ nh∆∞ng kh√¥ng c√≥ th√¥ng b√°o r√µ r√†ng.\");\r",
									"            }\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (statusCode === 500) {\r",
									"        pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"            if (!msg || msg.length === 0) {\r",
									"                pm.expect.fail(\"500 tr·∫£ v·ªÅ nh∆∞ng kh√¥ng c√≥ message l·ªói.\");\r",
									"            }\r",
									"            pm.expect(msg).to.match(/(l·ªói|error|server|backend)/i);\r",
									"        });\r",
									"\r",
									"        console.error(\" L·ªói 500 t·ª´ backend:\", msg);\r",
									"    }\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Id s√°ch kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"bookId\", \"999\"); \r",
									"// Id s√°ch h·ª£p l·ªá\r",
									"//pm.environment.set(\"bookId\", \"50\"); \r",
									"// // Id s√°ch kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"bookId\", \"@\"); \r",
									"// // Id s√°ch kh√¥ng ph·∫£i l√† s·ªë\r",
									"// pm.environment.set(\"bookId\", \"abc\");\r",
									"// // Id s√°ch kh√¥ng ph·∫£i l√† s·ªë nguy√™n\r",
									"// pm.environment.set(\"bookId\", \"-1\");\r",
									"// // Id s√°ch null\r",
									"// pm.environment.set(\"bookId\", \"null\");\r",
									"// // Id s√°ch r·ªóng\r",
									"// pm.environment.set(\"bookId\", \"\");\r",
									"//Ki·ªÉm tra Update th√†nh c√¥ng t·∫•t c·∫£ gi√° tr·ªã\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//   \"title\": \"Cu·ªôc ƒê·ªùi C·ªßa C√¥ G√°i Tr·∫ª\",\r",
									"//   \"author\": \"H·ªèa Tinh\",\r",
									"//   \"price\": 50000,\r",
									"//   \"category\": \"Ti·ªÉu thuy·∫øt\",\r",
									"//   \"stock\": 6,\r",
									"//   \"rating\": 5,\r",
									"//   \"publishedYear\": 2025,\r",
									"//   \"status\": \"available\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update tr√πng title\r",
									"//  pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//    \"title\": \"Cu·ªôc ƒê·ªùi C·ªßa C√¥ G√°i Tr·∫ª\",\r",
									"//  }));\r",
									"// //Ki·ªÉm tra update kh√¥ng c√≥ gi√° tr·ªã\r",
									"// //Ki·ªÉm tra update c√°c tr∆∞·ªùng r·ªóng title,author,category,status\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//   \"title\": \"\",\r",
									"//   \"author\": \"\",\r",
									"//   \"category\": \"\",\r",
									"//   \"status\": \"\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi price l√† s·ªë √¢m\r",
									"pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"    \"price\": -10000\r",
									"}));\r",
									"// //Ki·ªÉm tra update v·ªõi stock l√† s·ªë √¢m\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"stock\": -1\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi rating l√† s·ªë √¢m\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"rating\": -1\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi publishedYear l√† s·ªë √¢m\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"publishedYear\": -1\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi price l√† chu·ªói\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"price\": \"abc\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi stock l√† chu·ªói\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"stock\": \"abc\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi rating l√† chu·ªói\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"rating\": \"abc\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi publishedYear l√† chu·ªói\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"publishedYear\": \"abc\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi price l√† null\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi stock l√† null \r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi rating l√† null\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"// }));\r",
									"// //Ki·ªÉm tra update v·ªõi publishedYear l√† null\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi title l√† sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"title\": 123\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi author l√† sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"author\": 123\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi category l√† sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"category\": 123\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi status l√† sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"status\": 123\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi rating nh·ªè h∆°n 1\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"rating\": 0\r",
									"// }));\r",
									"// // Ki·ªÉm tra v·ªõi rating l·ªõn h∆°n 5\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"rating\": 6\r",
									"// }));\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear l·ªõn h∆°n nƒÉm hi√™n t·∫°i\r",
									"// pm.environment.set(\"updateBody\", JSON.stringify({\r",
									"//     \"publishedYear\": \"9999\"\r",
									"// }));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{updateBody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/books/{{bookId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books",
								"{{bookId}}"
							]
						},
						"description": "C·∫≠p nh·∫≠t to√†n b·ªô th√¥ng tin c·ªßa m·ªôt cu·ªën s√°ch theo id.  \nPh√π h·ª£p khi ch·ªânh s·ª≠a n·ªôi dung ho·∫∑c gi√° s√°ch.  \nN·∫øu id kh√¥ng t·ªìn t·∫°i, server kh√¥ng tr·∫£ v·ªÅ l·ªói nh∆∞ng kh√¥ng c√≥ g√¨ thay ƒë·ªïi."
					},
					"response": []
				},
				{
					"name": "Get Books Sorted by Price",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"// Ki·ªÉm tra token nghi ng·ªù l√† gi·∫£\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"// Danh s√°ch token gi·∫£ ƒë∆∞·ª£c cho ph√©p (test h·ª£p l·ªá)\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"// Test: Token kh√¥ng h·ª£p l·ªá nh∆∞ng tr·∫£ v·ªÅ 200 (c·∫£nh b√°o sai)\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"// Test: Header Authorization t·ªìn t·∫°i v√† c√≥ ƒë·ªãnh d·∫°ng ƒë√∫ng\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let books;\r",
									"let isJsonValid = true;\r",
									"\r",
									"try {\r",
									"    books = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.error(\"JSON kh√¥ng h·ª£p l·ªá:\", e);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// TEST CHUNG: STATUS CODE, HEADERS, TIME\r",
									"// ===============================\r",
									"const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"const url = pm.request.url.toString();\r",
									"\r",
									"pm.test(`Status code l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"if (isJsonValid && Array.isArray(books) && statusCode === 200) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi l√† m·∫£ng danh s√°ch s√°ch\", () => {\r",
									"        pm.expect(books).to.be.an(\"array\");\r",
									"    });\r",
									"\r",
									"    if (books.length > 0) {\r",
									"        let missingPrice = false;\r",
									"\r",
									"        books.forEach((book, index) => {\r",
									"            const prefix = `S√°ch #${index + 1}`;\r",
									"\r",
									"            pm.test(`${prefix} ‚Äì C√≥ ƒë·∫ßy ƒë·ªß tr∆∞·ªùng d·ªØ li·ªáu`, () => {\r",
									"                const requiredFields = [\r",
									"                    \"id\", \"title\", \"author\", \"price\",\r",
									"                    \"category\", \"stock\", \"rating\", \"publishedYear\", \"status\"\r",
									"                ];\r",
									"                const bookKeys = Object.keys(book);\r",
									"                const missing = requiredFields.filter(field => !bookKeys.includes(field));\r",
									"                if (missing.length > 0) {\r",
									"                    pm.expect.fail(`${prefix} thi·∫øu c√°c tr∆∞·ªùng: ${missing.join(\", \")}`);\r",
									"                }\r",
									"            });\r",
									"\r",
									"            pm.test(`${prefix} ‚Äì Ki·ªÉu d·ªØ li·ªáu v√† gi√° tr·ªã h·ª£p l·ªá`, () => {\r",
									"                try {\r",
									"                    pm.expect(book.id).to.be.a(\"string\");\r",
									"                    pm.expect(book.title).to.be.a(\"string\");\r",
									"                    pm.expect(book.author).to.be.a(\"string\");\r",
									"                    pm.expect(book.price).to.be.a(\"number\").and.to.be.at.least(0);\r",
									"                    pm.expect(book.category).to.be.a(\"string\");\r",
									"                    pm.expect(book.stock).to.be.a(\"number\").and.to.be.at.least(0);\r",
									"                    pm.expect(book.rating).to.be.a(\"number\").and.to.be.within(1, 5);\r",
									"                    pm.expect(book.publishedYear).to.be.a(\"number\").and.to.be.at.most(new Date().getFullYear());\r",
									"                    pm.expect([\"available\", \"out_of_stock\"]).to.include(book.status.toLowerCase());\r",
									"                } catch (e) {\r",
									"                    pm.expect.fail(`${prefix} c√≥ l·ªói d·ªØ li·ªáu: ${e.message}`);\r",
									"                }\r",
									"            });\r",
									"\r",
									"            // ƒê√°nh d·∫•u n·∫øu thi·∫øu gi√° ƒë·ªÉ kh√¥ng test sort\r",
									"            if (typeof book.price !== \"number\") {\r",
									"                missingPrice = true;\r",
									"            }\r",
									"        });\r",
									"\r",
									"        // N·∫øu c√≥ query sort=price, ki·ªÉm tra s·∫Øp x·∫øp ƒë√∫ng\r",
									"        if (!missingPrice && books.length > 1 && url.includes(\"sort=price\")) {\r",
									"            pm.test(\"Danh s√°ch ƒë∆∞·ª£c s·∫Øp x·∫øp theo gi√° tƒÉng d·∫ßn\", () => {\r",
									"                const isSorted = books.every((b, i, arr) => i === 0 || arr[i - 1].price <= b.price);\r",
									"                pm.expect(isSorted).to.be.true;\r",
									"            });\r",
									"        } else if (missingPrice && url.includes(\"sort=price\")) {\r",
									"            pm.test(\"Kh√¥ng th·ªÉ ki·ªÉm tra sort v√¨ c√≥ s√°ch thi·∫øu 'price'\", () => {\r",
									"                pm.expect.fail(\"C√≥ √≠t nh·∫•t m·ªôt s√°ch thi·∫øu tr∆∞·ªùng 'price'\");\r",
									"            });\r",
									"        }\r",
									"\r",
									"    } else {\r",
									"        pm.test(\"Danh s√°ch r·ªóng ‚Äì kh√¥ng c√≥ s√°ch\", () => {\r",
									"            pm.expect(books.length).to.eql(0);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"\r",
									"// N·∫øu c√≥ tham s·ªë sort nh∆∞ng kh√¥ng h·ª£p l·ªá\r",
									"const validSortFields = [\"price\", \"rating\", \"publishedYear\"];\r",
									"if (url.includes(\"sort=\")) {\r",
									"    const sortParam = url.split(\"sort=\")[1].split(\"&\")[0];\r",
									"    if (!validSortFields.includes(sortParam)) {\r",
									"        pm.test(\"Tham s·ªë sort kh√¥ng h·ª£p l·ªá ‚Äì n√™n tr·∫£ 400\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// 400 - L·ªói truy v·∫•n\r",
									"if (statusCode === 400) {\r",
									"    const msg = (books?.message || \"\").toLowerCase();\r",
									"    pm.test(\"L·ªói truy v·∫•n kh√¥ng h·ª£p l·ªá (400)\", () => {\r",
									"        pm.expect(msg).to.match(/invalid|l·ªói|kh√¥ng h·ª£p l·ªá|tham s·ªë/i);\r",
									"    });\r",
									"}\r",
									"\r",
									"// 401 - Ch∆∞a x√°c th·ª±c\r",
									"if (statusCode === 401) {\r",
									"    const msg = (books?.message || \"\").toLowerCase();\r",
									"    pm.test(\"Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(msg).to.include(\"x√°c th·ª±c\");\r",
									"    });\r",
									"\r",
									"    pm.test(\"401 - C·∫£nh b√°o c·∫ßn ki·ªÉm tra token\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// 403 - Kh√¥ng c√≥ quy·ªÅn\r",
									"if (statusCode === 403) {\r",
									"    const msg = (books?.message || \"\").toLowerCase();\r",
									"    pm.test(\"Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p (403)\", () => {\r",
									"        pm.expect(msg).to.include(\"kh√¥ng c√≥ quy·ªÅn\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// 404 - Kh√¥ng t√¨m th·∫•y t√†i nguy√™n\r",
									"if (statusCode === 404) {\r",
									"    const msg = (books?.message || \"\").toLowerCase();\r",
									"    pm.test(\"Kh√¥ng t√¨m th·∫•y t√†i nguy√™n (404)\", () => {\r",
									"        pm.expect(msg).to.include(\"kh√¥ng t·ªìn t·∫°i\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// 500 - L·ªói ph√≠a server\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/books?sort=price",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books"
							],
							"query": [
								{
									"key": "sort",
									"value": "price"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete book",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"// X√°c ƒë·ªãnh token nghi ng·ªù kh√¥ng h·ª£p l·ªá\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"// Token ƒë∆∞·ª£c ph√©p test gi·∫£ l·∫≠p\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"// C·∫£nh b√°o n·∫øu token sai nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"// Ki·ªÉm tra ƒë·ªãnh d·∫°ng Authorization\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let body;\r",
									"let isJson = true;\r",
									"\r",
									"try {\r",
									"    body = pm.response.json();\r",
									"} catch (err) {\r",
									"    isJson = false;\r",
									"    console.error(\"Kh√¥ng th·ªÉ parse JSON:\", err);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// TEST CHUNG: STATUS CODE, TIME, HEADERS\r",
									"// ===============================\r",
									"pm.test(`M√£ tr·∫°ng th√°i l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 403, 404, 401, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Th·ªùi gian ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"const bookId = pm.request.url.variables.get(\"bookId\") || pm.request.url.toString().split('/').pop();\r",
									"\r",
									"if (statusCode === 200 && isJson && typeof body === 'object') {\r",
									"    // Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß\r",
									"    pm.test(\"Ph·∫£n h·ªìi ch·ª©a ƒë·∫ßy ƒë·ªß tr∆∞·ªùng s√°ch\", () => {\r",
									"        const requiredFields = [\r",
									"            \"id\", \"title\", \"author\", \"price\", \"category\",\r",
									"            \"stock\", \"rating\", \"publishedYear\", \"status\"\r",
									"        ];\r",
									"        requiredFields.forEach(field => {\r",
									"            pm.expect(body).to.have.property(field, undefined, `Thi·∫øu tr∆∞·ªùng '${field}'`);\r",
									"        });\r",
									"    });\r",
									"\r",
									"    // Ki·ªÉm tra logic sau khi x√≥a\r",
									"    pm.test(\"Tr∆∞·ªùng 'status' sau khi x√≥a l√† 'out_of_stock'\", () => {\r",
									"        pm.expect(body).to.have.property(\"status\");\r",
									"        pm.expect(body.status).to.eql(\"out_of_stock\");\r",
									"    });\r",
									"\r",
									"    console.log(\"S√°ch ƒë√£ x√≥a:\", body);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù C√ÅC TR∆Ø·ªúNG H·ª¢P L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"\r",
									"// 400 - L·ªói ƒë·∫ßu v√†o\r",
									"if (statusCode === 400 && isJson) {\r",
									"    const msg = (body.message || \"\").toLowerCase();\r",
									"\r",
									"    if (/kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng|ph·∫£i l√† s·ªë/.test(msg)) {\r",
									"        pm.test(\"bookId kh√¥ng h·ª£p l·ªá (400)\", () => {\r",
									"            pm.expect(msg).to.match(/kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng|ph·∫£i l√† s·ªë/i);\r",
									"        });\r",
									"    } else if (msg.includes(\"out_of_stock\")) {\r",
									"        pm.test(\"S√°ch ƒë√£ out_of_stock tr∆∞·ªõc ƒë√≥ (400)\", () => {\r",
									"            pm.expect(msg).to.include(\"out_of_stock\");\r",
									"        });\r",
									"    } else {\r",
									"        pm.test(\"L·ªói 400 kh√¥ng x√°c ƒë·ªãnh n·ªôi dung\", () => {\r",
									"            pm.expect.fail(`Th√¥ng b√°o kh√¥ng r√µ r√†ng: ${body.message}`);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// 404 - Kh√¥ng t√¨m th·∫•y s√°ch\r",
									"else if (statusCode === 404 && isJson) {\r",
									"    const msg = (body.message || \"\").toLowerCase();\r",
									"\r",
									"    if (msg.includes(\"thi·∫øu id\")) {\r",
									"        pm.test(\"Thi·∫øu bookId trong URL (404)\", () => {\r",
									"            pm.expect(body.message).to.eql(\"Thi·∫øu ID trong URL. V√≠ d·ª• ƒë√∫ng: /books/1\");\r",
									"        });\r",
									"    } else {\r",
									"        pm.test(\"Kh√¥ng t√¨m th·∫•y s√°ch (404)\", () => {\r",
									"            pm.expect(msg).to.include(\"kh√¥ng t√¨m th·∫•y\");\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// 403 - Kh√¥ng c√≥ quy·ªÅn x√≥a\r",
									"else if (statusCode === 403 && isJson) {\r",
									"    const msg = (body.message || \"\").toLowerCase();\r",
									"\r",
									"    pm.test(\"Ng∆∞·ªùi d√πng kh√¥ng c√≥ quy·ªÅn x√≥a s√°ch (403)\", () => {\r",
									"        pm.expect(msg).to.match(/kh√¥ng c√≥ quy·ªÅn.*x√≥a s√°ch/i);\r",
									"    });\r",
									"\r",
									"    // Ki·ªÉm tra theo role t·ª´ m√¥i tr∆∞·ªùng\r",
									"    const currentUserRole = pm.environment.get(\"currentUserRole\") || \"user\";\r",
									"    if (currentUserRole === \"user\") {\r",
									"        pm.test(\"Ng∆∞·ªùi d√πng th∆∞·ªùng b·ªã t·ª´ ch·ªëi quy·ªÅn x√≥a s√°ch\", () => {\r",
									"            pm.expect(statusCode).to.eql(403);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"// Truy·ªÅn bookId null ho·∫∑c r·ªóng\r",
									"else if (isJson && (!bookId || bookId === \"null\" || bookId === \"\")) {\r",
									"    pm.test(\"Kh√¥ng truy·ªÅn ho·∫∑c truy·ªÅn bookId null/r·ªóng\", () => {\r",
									"        pm.expect.fail(\"Kh√¥ng truy·ªÅn ho·∫∑c truy·ªÅn bookId null/r·ªóng trong URL.\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// 401 - Ch∆∞a x√°c th·ª±c\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// 500 - L·ªói server\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// Tr∆∞·ªùng h·ª£p kh√¥ng x√°c ƒë·ªãnh kh√°c\r",
									"else if (![200, 400, 403, 404, 401, 500].includes(statusCode)) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi l·ªói kh√¥ng x√°c ƒë·ªãnh\", () => {\r",
									"        pm.expect(isJson).to.be.true;\r",
									"        console.warn(\"N·ªôi dung ph·∫£n h·ªìi kh√¥ng x√°c ƒë·ªãnh:\", body);\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Id s√°ch kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"bookId\", \"999\"); \r",
									"// // Id s√°ch h·ª£p l·ªá\r",
									"// pm.environment.set(\"bookId\", \"50\"); \r",
									"// // Id s√°ch kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"bookId\", \"@\"); \r",
									"// // Id s√°ch kh√¥ng ph·∫£i l√† s·ªë\r",
									"// pm.environment.set(\"bookId\", \"abc\");\r",
									"// // Id s√°ch kh√¥ng ph·∫£i l√† s·ªë nguy√™n\r",
									"// pm.environment.set(\"bookId\", \"-1\");\r",
									"// // Id s√°ch null\r",
									"// pm.environment.set(\"bookId\", \"null\");\r",
									"// // Id s√°ch r·ªóng\r",
									"// pm.environment.set(\"bookId\", \"\");\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{user_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{base_url}}/books/{{bookId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books",
								"{{bookId}}"
							]
						},
						"description": "Xo√° m·ªôt cu·ªën s√°ch kh·ªèi h·ªá th·ªëng theo id.  \nƒê√¢y l√† thao t√°c ‚ÄúDelete‚Äù trong CRUD.  \nSau khi xo√°, c√≥ th·ªÉ ki·ªÉm tra l·∫°i b·∫±ng Get all books ƒë·ªÉ x√°c nh·∫≠n."
					},
					"response": []
				},
				{
					"name": "Search books",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"//================TITLE====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','null');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"//Ki·ªÉm tra v·ªõi titleName ƒë√∫ng\r",
									"// pm.environment.set('titleName','M·∫Øc bi·∫øc');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"//Ki·ªÉm tra v·ªõi titleName ph√¢n bi·ªát hoa th∆∞·ªùng\r",
									"// pm.environment.set('titleName','m·∫Øc bi·∫øc');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi titleName b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','@');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi titleName sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','123');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"\r",
									"//================AUTHOR====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','null');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi authorName ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','Nguy·ªÖn Nh·∫≠t √Ånh');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi authorName ph√¢n bi·ªát hoa th∆∞·ªùng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','Nguy·ªÖn NH·∫¨T √Ånh');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi authorName b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','@');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi authorName sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','123');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"\r",
									"\r",
									"//================PRICE====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','null');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi price ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','95000');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi price b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','@');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi price sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','abc');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi price l√† s·ªë √¢m\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','-95000');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"\r",
									"\r",
									"//================CATEGORY====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','null');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi categoryName ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','Ti·ªÉu thuy·∫øt');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi categoryName ph√¢n bi·ªát hoa th∆∞·ªùng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','TI·ªÇU THUY·∫æT');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi categoryName b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','@');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi categoryName sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','123');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"\r",
									"//================STOCK====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','null');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi stock ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','4');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi stock b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','@');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi stock sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','abc');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi stock l√† s·ªë √¢m\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','-9');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"\r",
									"//================PUBLISHEDYEAR====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','null');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','2025');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','@');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','abc');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear l√† s·ªë √¢m\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','-2025');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi publishedYear b√© h∆°n nƒÉm hi·ªán t·∫°i\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','9999');\r",
									"// pm.environment.set('statusName','');\r",
									"\r",
									"//================STATUS====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','null');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi statusName ƒë√∫ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','available');\r",
									"// //Ki·ªÉm tra v·ªõi statusName ph√¢n bi·ªát hoa th∆∞·ªùng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','AVAILABLE');\r",
									"// //Ki·ªÉm tra v·ªõi statusName b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','@');\r",
									"// //Ki·ªÉm tra v·ªõi statusName sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','123');\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let resData;\r",
									"let isJson = false;\r",
									"try {\r",
									"    resData = pm.response.json();\r",
									"    isJson = true;\r",
									"} catch (e) {\r",
									"    console.error(\"Kh√¥ng th·ªÉ parse JSON:\", e);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// TEST CHUNG: STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ===============================\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 403, 404, 500, 401]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Th·ªùi gian ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"const stringFields = [\"title\", \"author\", \"category\", \"status\"];\r",
									"const numberFields = [\"price\", \"stock\", \"rating\", \"publishedYear\"];\r",
									"\r",
									"// L·∫•y gi√° tr·ªã t·ª´ bi·∫øn m√¥i tr∆∞·ªùng\r",
									"const envValues = {};\r",
									"[...stringFields, ...numberFields].forEach(field => {\r",
									"    const rawDirect = pm.environment.get(field);\r",
									"    const rawNamed = pm.environment.get(field + \"Name\");\r",
									"    const raw = rawNamed ?? rawDirect;\r",
									"\r",
									"    if (![\"\", \"null\", null, undefined].includes(raw)) {\r",
									"        envValues[field] = raw.trim();\r",
									"    }\r",
									"});\r",
									"\r",
									"// H√†m x√°c ƒë·ªãnh gi√° tr·ªã kh√¥ng h·ª£p l·ªá\r",
									"const isInvalidInput = (field, value) => {\r",
									"    const isInvalidNumber = numberFields.includes(field) && isNaN(Number(value));\r",
									"    const isEmptyOrNull = value === \"\" || value.toLowerCase() === \"null\";\r",
									"    const isSpecialChar = /^[\\W_]+$/.test(value);\r",
									"    const isNegative = numberFields.includes(field) && Number(value) < 0;\r",
									"    const isFutureYear = field === \"publishedYear\" && Number(value) > new Date().getFullYear();\r",
									"    const isOnlyDigits = stringFields.includes(field) && /^\\d+$/.test(value);\r",
									"    return isInvalidNumber || isEmptyOrNull || isSpecialChar || isNegative || isFutureYear || isOnlyDigits;\r",
									"};\r",
									"\r",
									"// N·∫øu tr·∫£ v·ªÅ 200 v√† c√≥ m·∫£ng k·∫øt qu·∫£\r",
									"if (statusCode === 200 && isJson && Array.isArray(resData)) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi l√† m·∫£ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(Array.isArray(resData)).to.be.true;\r",
									"    });\r",
									"\r",
									"    let foundInvalid = false;\r",
									"\r",
									"    // N·∫øu c√≥ input sai m√† v·∫´n tr·∫£ 200 l√† l·ªói\r",
									"    Object.entries(envValues).forEach(([field, value]) => {\r",
									"        if (isInvalidInput(field, value)) {\r",
									"            foundInvalid = true;\r",
									"            pm.test(`BUG: '${field}' sai ƒë·ªãnh d·∫°ng nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200`, () => {\r",
									"                pm.expect.fail(`'${field}' = '${value}' kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"            });\r",
									"        }\r",
									"    });\r",
									"\r",
									"    if (!foundInvalid && resData.length > 0) {\r",
									"        const book = resData[0];\r",
									"\r",
									"        // So s√°nh d·ªØ li·ªáu tr·∫£ v·ªÅ kh·ªõp v·ªõi gi√° tr·ªã t√¨m ki·∫øm\r",
									"        Object.entries(envValues).forEach(([field, value]) => {\r",
									"            pm.test(`D·ªØ li·ªáu tr·∫£ v·ªÅ kh·ªõp '${field}'`, () => {\r",
									"                const actual = book[field];\r",
									"                if (stringFields.includes(field)) {\r",
									"                    pm.expect(actual.toLowerCase()).to.include(value.toLowerCase());\r",
									"                } else {\r",
									"                    pm.expect(actual).to.eql(Number(value));\r",
									"                }\r",
									"            });\r",
									"        });\r",
									"    } else if (!foundInvalid && resData.length === 0) {\r",
									"        // G·ª£i √Ω n·∫øu c√≥ th·ªÉ do ph√¢n bi·ªát hoa th∆∞·ªùng\r",
									"        Object.entries(envValues).forEach(([field, value]) => {\r",
									"            if (stringFields.includes(field)) {\r",
									"                const hasLower = /[a-z√†-·ªπ]/.test(value);\r",
									"                const hasUpper = /[A-Z√Ä-·ª∏]/.test(value);\r",
									"                const isLikelyCased = hasLower && hasUpper;\r",
									"\r",
									"                if (isLikelyCased) {\r",
									"                    pm.test(`C√≥ th·ªÉ ph√¢n bi·ªát HOA - th∆∞·ªùng ·ªü '${field}'`, () => {\r",
									"                        pm.expect.fail(`Ph√¢n bi·ªát HOA - th∆∞·ªùng v·ªõi '${value}'`);\r",
									"                    });\r",
									"                }\r",
									"            }\r",
									"        });\r",
									"\r",
									"        pm.test(\"Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o (m·∫£ng r·ªóng)\", () => {\r",
									"            pm.expect(resData.length).to.eql(0);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù C√ÅC M√É L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"if (statusCode === 400 && isJson) {\r",
									"    const msg = (resData.message || \"\").toLowerCase();\r",
									"\r",
									"    pm.test(\"400 - L·ªói input kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"\r",
									"    Object.entries(envValues).forEach(([field, value]) => {\r",
									"        if (isInvalidInput(field, value)) {\r",
									"            pm.test(`'${field}' sai ƒë·ªãnh d·∫°ng, tr·∫£ v·ªÅ 400 h·ª£p l√Ω`, () => {\r",
									"                pm.expect(statusCode).to.eql(400);\r",
									"                if (msg.includes(field.toLowerCase())) {\r",
									"                    pm.expect(msg).to.include(field.toLowerCase());\r",
									"                } else {\r",
									"                    console.warn(`Message kh√¥ng ch·ª©a t√™n field '${field}'`);\r",
									"                }\r",
									"            });\r",
									"        }\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 403 && isJson) {\r",
									"    const msg = (resData.message || \"\").toLowerCase();\r",
									"    pm.test(\"403 - Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p\", () => {\r",
									"        pm.expect(msg).to.include(\"kh√¥ng c√≥ quy·ªÅn\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 404 && isJson) {\r",
									"    const msg = (resData.message || \"\").toLowerCase();\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu\", () => {\r",
									"        pm.expect(msg).to.include(\"kh√¥ng t√¨m th·∫•y\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500 && isJson) {\r",
									"    const msg = (resData.message || \"\").toLowerCase();\r",
									"    pm.test(\"500 - L·ªói server\", () => {\r",
									"        pm.expect(msg).to.include(\"l·ªói\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/books?status={{statusName}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books"
							],
							"query": [
								{
									"key": "status",
									"value": "{{statusName}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get book by rating",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //================RATING====================//\r",
									"// //Ki·ªÉm tra titleName v·ªõi titletitle,authorName,price,categoryName,stock,rating,publishedYear,statusName  = null\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','null');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra titleName v·ªõi title,authorName,price,categoryName,stock,rating,publishedYear,statusName = r·ªóng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"//Ki·ªÉm tra v·ªõi rating ƒë√∫ng\r",
									"pm.environment.set('titleName','');\r",
									"pm.environment.set('authorName','');\r",
									"pm.environment.set('price','');\r",
									"pm.environment.set('categoryName','');\r",
									"pm.environment.set('stock','');\r",
									"pm.environment.set('rating','4');\r",
									"pm.environment.set('publishedYear','');\r",
									"pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi rating b·∫±ng k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','@');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi rating sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','abc');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"//Ki·ªÉm tra v·ªõi rating l√† s·ªë √¢m\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','');\r",
									"// pm.environment.set('rating','-1');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"//Ki·ªÉm tra v·ªõi rating b√© h∆°n 1\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','0');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');\r",
									"// //Ki·ªÉm tra v·ªõi rating l·ªõn h∆°n 5\r",
									"// pm.environment.set('titleName','');\r",
									"// pm.environment.set('authorName','');\r",
									"// pm.environment.set('price','');\r",
									"// pm.environment.set('categoryName','');\r",
									"// pm.environment.set('stock','6');\r",
									"// pm.environment.set('rating','');\r",
									"// pm.environment.set('publishedYear','');\r",
									"// pm.environment.set('statusName','');"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  PARSE JSON PH·∫¢N H·ªíI\r",
									"// ===============================\r",
									"let resData = {};\r",
									"let isJson = false;\r",
									"try {\r",
									"    resData = pm.response.json();\r",
									"    isJson = true;\r",
									"} catch (e) {\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON t·ª´ response.\");\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// TEST CHUNG: STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ===============================\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 404, 500, 401]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Th·ªùi gian ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"const ratingRaw = pm.environment.get(\"rating\");\r",
									"const ratingNumber = Number(ratingRaw);\r",
									"\r",
									"const isValidRating =\r",
									"    ratingRaw !== undefined &&\r",
									"    ratingRaw !== null &&\r",
									"    ratingRaw !== \"\" &&\r",
									"    !isNaN(ratingNumber) &&\r",
									"    ratingNumber >= 1 &&\r",
									"    ratingNumber <= 5;\r",
									"\r",
									"const explain = `Gi√° tr·ªã rating ƒëang test: '${ratingRaw}'`;\r",
									"\r",
									"if (statusCode === 200) {\r",
									"    pm.test(\"200 - Rating h·ª£p l·ªá (1‚Äì5)\", () => {\r",
									"        pm.expect(isValidRating, `rating kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200. ${explain}`).to.be.true;\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"// X·ª¨ L√ù L·ªñI: 400, 401, 500\r",
									"// ===============================\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\"400 - Rating kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(!isValidRating, `rating h·ª£p l·ªá nh∆∞ng l·∫°i tr·∫£ v·ªÅ 400. ${explain}`).to.be.true;\r",
									"    });\r",
									"\r",
									"    if (isJson && resData.message) {\r",
									"        pm.test(\"Message l·ªói ch·ª©a 'kh√¥ng h·ª£p l·ªá'\", () => {\r",
									"            pm.expect(resData.message.toLowerCase()).to.include(\"kh√¥ng h·ª£p l·ªá\");\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/books?rating={{rating}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"books"
							],
							"query": [
								{
									"key": "rating",
									"value": "{{rating}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Users",
			"item": [
				{
					"name": "Get all users",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ======================================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// PARSE PH·∫¢N H·ªíI JSON\r",
									"// ======================================\r",
									"let response = {};\r",
									"let isJsonValid = true;\r",
									"\r",
									"try {\r",
									"    response = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJsonValid = false;\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", e);\r",
									"    pm.environment.set(\"inforMessage\", \"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá.\");\r",
									"}\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// TEST CHUNG (status code, time, content-type)\r",
									"// ======================================\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Th·ªùi gian ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// LOGIC KHI STATUS = 200 (L·∫•y danh s√°ch user)\r",
									"// ======================================\r",
									"if (statusCode === 200 && Array.isArray(response)) {\r",
									"    pm.test(\"200 - Response l√† m·∫£ng\", () => {\r",
									"        pm.expect(Array.isArray(response)).to.be.true;\r",
									"    });\r",
									"\r",
									"    pm.test(\"200 - C√≥ √≠t nh·∫•t 1 user\", () => {\r",
									"        pm.expect(response.length).to.be.above(0);\r",
									"    });\r",
									"\r",
									"    response.forEach((user, index) => {\r",
									"        const fields = {\r",
									"            id: \"string\",\r",
									"            username: \"string\",\r",
									"            password: \"string\",\r",
									"            role: [\"admin\", \"user\"],\r",
									"            email: \"string\",\r",
									"            address: \"string\",\r",
									"            status: \"string\",\r",
									"            fullName: \"string\"\r",
									"        };\r",
									"\r",
									"        for (const field in fields) {\r",
									"            const actualField = user.hasOwnProperty(field)\r",
									"                ? field\r",
									"                : (user.hasOwnProperty(field.toLowerCase()) ? field.toLowerCase() : null);\r",
									"\r",
									"            pm.test(`User ${index + 1} c√≥ tr∆∞·ªùng '${field}'`, () => {\r",
									"                pm.expect(actualField, `Thi·∫øu tr∆∞·ªùng '${field}'`).to.not.be.null;\r",
									"            });\r",
									"\r",
									"            if (actualField) {\r",
									"                const value = user[actualField];\r",
									"\r",
									"                if (typeof fields[field] === \"string\") {\r",
									"                    pm.test(`'${field}' l√† ki·ªÉu ${fields[field]}`, () => {\r",
									"                        pm.expect(value).to.be.a(fields[field]);\r",
									"                    });\r",
									"                }\r",
									"\r",
									"                if (Array.isArray(fields[field])) {\r",
									"                    pm.test(`'role' h·ª£p l·ªá`, () => {\r",
									"                        pm.expect(fields[field]).to.include(value);\r",
									"                    });\r",
									"                }\r",
									"\r",
									"                if (field === \"email\") {\r",
									"                    pm.test(\"Email h·ª£p l·ªá\", () => {\r",
									"                        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r",
									"                        pm.expect(emailRegex.test(value)).to.be.true;\r",
									"                    });\r",
									"                }\r",
									"            }\r",
									"        }\r",
									"    });\r",
									"\r",
									"    // L∆∞u userId v√†o m√¥i tr∆∞·ªùng\r",
									"    pm.environment.set(\"userId\", response[0].id);\r",
									"    console.log(\"ƒê√£ l∆∞u userId:\", response[0].id);\r",
									"}\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// X·ª¨ L√ù L·ªñI KH√ÅC\r",
									"// ======================================\r",
									"else if (statusCode === 400) {\r",
									"    const msg = (response.message || \"\").toLowerCase();\r",
									"    pm.test(\"400 - Th√¥ng b√°o l·ªói h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg).to.have.length.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"else if (statusCode === 401) {\r",
									"    const msg = (response.message || \"\").toLowerCase();\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c\", () => {\r",
									"        pm.expect(msg).to.include(\"unauthorized\").or.include(\"kh√¥ng c√≥ quy·ªÅn\");\r",
									"    });\r",
									"}\r",
									"\r",
									"else if (statusCode === 403) {\r",
									"    const msg = (response.message || \"\").trim();\r",
									"    pm.test(\"403 - C√≥ th√¥ng b√°o l·ªói\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"else if (statusCode === 404) {\r",
									"    const msg = (response.message || \"\").toLowerCase();\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y\", () => {\r",
									"        pm.expect(msg).to.include(\"not found\").or.include(\"kh√¥ng t√¨m th·∫•y\");\r",
									"    });\r",
									"}\r",
									"\r",
									"else if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									"\r",
									"else {\r",
									"    pm.test(\"Tr·∫°ng th√°i ch∆∞a ƒë∆∞·ª£c x·ª≠ l√Ω r√µ\", () => {\r",
									"        pm.expect.fail(`Ch∆∞a c√≥ test case c·ª• th·ªÉ cho status ${statusCode}`);\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// // N·∫øu ch∆∞a c√≥ th√¨ set token m·∫∑c ƒë·ªãnh\r",
									"// if (!pm.environment.get(\"admin_token\")) {\r",
									"//     pm.environment.set(\"admin_token\", \"fake-admin-token-999\");\r",
									"// }\r",
									"\r",
									"// // G√°n Authorization header\r",
									"// pm.request.headers.upsert({\r",
									"//     key: \"Authorization\",\r",
									"//     value: `Bearer ${pm.environment.get(\"admin_token\")}`\r",
									"// });\r",
									"\r",
									"// // G√°n Content-Type n·∫øu ch∆∞a c√≥\r",
									"// pm.request.headers.upsert({\r",
									"//     key: \"Content-Type\",\r",
									"//     value: \"application/json\"\r",
									"// });\r",
									"\r",
									"//====================USER================//\r",
									"//Ki·ªÉm tra ƒëƒÉng nh·∫≠p b·∫±ng user\r",
									"// N·∫øu ch∆∞a c√≥ th√¨ set token m·∫∑c ƒë·ªãnh\r",
									"if (!pm.environment.get(\"user_token\")) {\r",
									"    pm.environment.set(\"user_token\", \"fake-user-token-123\");\r",
									"}\r",
									"\r",
									"// G√°n Authorization header\r",
									"pm.request.headers.upsert({\r",
									"    key: \"Authorization\",\r",
									"    value: `Bearer ${pm.environment.get(\"user_token\")}`\r",
									"});\r",
									"\r",
									"// G√°n Content-Type n·∫øu ch∆∞a c√≥\r",
									"pm.request.headers.upsert({\r",
									"    key: \"Content-Type\",\r",
									"    value: \"application/json\"\r",
									"});\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get user by ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ======================================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  PARSE PH·∫¢N H·ªíI JSON\r",
									"// ======================================\r",
									"let json = {};\r",
									"let isJson = true;\r",
									"\r",
									"try {\r",
									"    json = pm.response.json();\r",
									"} catch (err) {\r",
									"    isJson = false;\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", err);\r",
									"}\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  TEST CHUNG: STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ======================================\r",
									"const userId = pm.request.url.variables.get(\"userId\") || pm.request.url.toString().split('/').pop();\r",
									"console.log(`ƒêang test v·ªõi userId = '${userId}'`);\r",
									"console.log(`Status code: ${statusCode}`);\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime}ms`);\r",
									"\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† JSON\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  X·ª¨ L√ù THEO STATUS CODE\r",
									"// ======================================\r",
									"\r",
									"// === 200 OK ===\r",
									"if (statusCode === 200 && isJson) {\r",
									"    pm.test(\"200 - D·ªØ li·ªáu tr·∫£ v·ªÅ c√≥ field 'id'\", () => {\r",
									"        pm.expect(json).to.have.property(\"id\");\r",
									"        pm.expect(json.id).to.be.a(\"string\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// === 400 Bad Request ===\r",
									"else if (statusCode === 400 && isJson) {\r",
									"    const msg = (json.message || \"\").trim();\r",
									"    pm.test(\"400 - Request kh√¥ng h·ª£p l·ªá c√≥ message\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"// === 403 Forbidden ===\r",
									"else if (statusCode === 403 && isJson) {\r",
									"    const msg = (json.message || \"\").trim();\r",
									"    pm.test(\"403 - Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"// === 404 Not Found ===\r",
									"else if (statusCode === 404 && isJson) {\r",
									"    const msg = (json.message || \"\").trim();\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y userId\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"}\r",
									"\r",
									"// === 401 Unauthorized ===\r",
									"else if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// === 500 Internal Server Error ===\r",
									"else if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									"\r",
									"// === Tr·∫°ng th√°i kh√°c ch∆∞a r√µ r√†ng ===\r",
									"else {\r",
									"    pm.test(\"Status code ch∆∞a ƒë∆∞·ª£c ki·ªÉm so√°t\", () => {\r",
									"        pm.expect.fail(`Ch∆∞a x·ª≠ l√Ω r√µ r√†ng v·ªõi status ${statusCode}`);\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra userId ƒë√∫ng\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"// //Ki·ªÉm tra userId null\r",
									"//pm.environment.set(\"userId\", \"null\");\r",
									"// //Ki·ªÉm tra userId r·ªóng\r",
									"//pm.environment.set(\"userId\", \"\");\r",
									"// //Ki·ªÉm tra userId kh√¥ng t√¥ng t·∫°i\r",
									"//pm.environment.set(\"userId\", \"999\");\r",
									"// //Ki·ªÉm tra userId sai ƒë·ªãnh d·∫°ng\r",
									"//pm.environment.set(\"userId\", \"abc\");\r",
									"// //Ki·ªÉm tra userId gi√° tr·ªã √¢m\r",
									"// pm.environment.set(\"userId\", \"-1\");\r",
									"// //Ki·ªÉm tra userId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"//pm.environment.set(\"userId\", \"@\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/users/{{userId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create new user",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"\r",
									"// ======================================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ======================================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  PARSE PH·∫¢N H·ªíI JSON AN TO√ÄN\r",
									"// ======================================\r",
									"let resJson = {};\r",
									"let isJson = true;\r",
									"\r",
									"try {\r",
									"    resJson = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJson = false;\r",
									"    console.error(\"Kh√¥ng parse ƒë∆∞·ª£c JSON t·ª´ response:\", e);\r",
									"    pm.environment.set(\"inforMessage\", \"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON.\");\r",
									"}\r",
									"\r",
									"if (!isJson) return;\r",
									"\r",
									"// Chuy·ªÉn keys th√†nh ch·ªØ th∆∞·ªùng ƒë·ªÉ x·ª≠ l√Ω kh√¥ng ph√¢n bi·ªát HOA-th∆∞·ªùng\r",
									"const user = {};\r",
									"for (const key in resJson) {\r",
									"    user[key.toLowerCase()] = resJson[key];\r",
									"}\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  TEST CHUNG: STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ======================================\r",
									"pm.test(`M√£ tr·∫°ng th√°i l√† ${statusCode}`, () => {\r",
									"    pm.expect([200, 201, 400, 403, 404, 409]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  LOGIC KHI STATUS = 200 HO·∫∂C 201\r",
									"// ======================================\r",
									"if ([200, 201].includes(statusCode)) {\r",
									"    const requiredFields = {\r",
									"        id: \"string\",\r",
									"        username: \"string\",\r",
									"        password: \"string\",\r",
									"        fullname: \"string\",\r",
									"        email: \"string\",\r",
									"        role: \"string\",\r",
									"        address: \"string\",\r",
									"        status: \"string\"\r",
									"    };\r",
									"\r",
									"    pm.test(\"Ph·∫£n h·ªìi c√≥ ƒë·∫ßy ƒë·ªß tr∆∞·ªùng & ki·ªÉu ƒë√∫ng\", () => {\r",
									"        for (const field in requiredFields) {\r",
									"            pm.expect(user, `Thi·∫øu tr∆∞·ªùng '${field}'`).to.have.property(field);\r",
									"            pm.expect(user[field], `Tr∆∞·ªùng '${field}' ph·∫£i l√† ki·ªÉu ${requiredFields[field]}`).to.be.a(requiredFields[field]);\r",
									"        }\r",
									"    });\r",
									"\r",
									"    pm.test(\"Role ph·∫£i l√† 'admin' ho·∫∑c 'user'\", () => {\r",
									"        pm.expect(user.role).to.be.oneOf([\"admin\", \"user\"]);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Email h·ª£p l·ªá\", () => {\r",
									"        pm.expect(user.email).to.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Status l√† 'active' ho·∫∑c 'unactive'\", () => {\r",
									"        pm.expect(user.status).to.be.oneOf([\"active\", \"unactive\"]);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Password ƒë·ªß m·∫°nh\", () => {\r",
									"        const pass = user.password;\r",
									"        pm.expect(pass.length >= 8, \"Password ph·∫£i >= 8 k√Ω t·ª±\").to.be.true;\r",
									"        pm.expect(/[!@#$%^&*(),.?\":{}|<>]/.test(pass), \"Password ph·∫£i c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát\").to.be.true;\r",
									"    });\r",
									"\r",
									"    // L∆∞u userId\r",
									"    if (user.id) {\r",
									"        pm.environment.set(\"userId\", user.id);\r",
									"        console.log(`ƒê√£ l∆∞u userId: ${user.id}`);\r",
									"    }\r",
									"}\r",
									"\r",
									"\r",
									"// ======================================\r",
									"//  X·ª¨ L√ù L·ªñI KH√ÅC\r",
									"// ======================================\r",
									"if ([400, 403, 409].includes(statusCode)) {\r",
									"    const msg = (user.message || \"\").toLowerCase();\r",
									"\r",
									"    pm.test(\"C√≥ th√¥ng b√°o l·ªói ph√π h·ª£p\", () => {\r",
									"        pm.expect(msg).to.not.be.empty;\r",
									"        pm.expect(msg).to.match(/username|password|email|status|role|kho·∫£ng tr·∫Øng|tr√πng|duplicate|invalid|thi·∫øu|b·∫Øt bu·ªôc|required/);\r",
									"    });\r",
									"\r",
									"    if (msg.includes(\"username\") && msg.includes(\"tr√πng\")) {\r",
									"        pm.test(\"Username kh√¥ng ƒë∆∞·ª£c tr√πng\", () => {\r",
									"            pm.expect(msg).to.include(\"tr√πng\");\r",
									"        });\r",
									"    }\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// // Ki·ªÉm tra t·∫°o th√†nh c√¥ng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Luan\",\r",
									"//   password: \"Luan1234@@\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Lu·∫≠n\",\r",
									"//   email: \"luannguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"\r",
									"// // Ki·ªÉm tra username ƒë√£ t·ªìn t·∫°i\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Cuong\",\r",
									"//   password: \"Cuong1234@\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Tr·∫ßn Minh C∆∞·ªùng\",\r",
									"//   email: \"cuongtran@gmail.com\",\r",
									"//   address: \"Vi·ªát Nam\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"\r",
									"// // Ki·ªÉm tra t·∫°o thi·∫øu tr∆∞·ªùng username,password,role,fullname,email,address,status\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng username ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng password ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng role ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng fullname ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng email ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng address ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra t·∫°o tr∆∞·ªùng status ƒë·ªÉ tr·ªëng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra email sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@@abc123\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyengmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"active\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra status kh√¥ng ph·∫£i active ho·∫∑c unactive\r",
									"pm.environment.set(\"userBody\", JSON.stringify({\r",
									"  username: \"Hoa\",\r",
									"  password: \"Hoa@@abc123\",\r",
									"  role: \"user\",\r",
									"  fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"  email: \"hoanguyen@gmail.com\",\r",
									"  address: \"H√†n Qu·ªëc\",\r",
									"  status: \"Qactive\"\r",
									"}));\r",
									"// //Ki·ªÉm tra password thi·∫øu ƒë·ªô d√†i(√≠t nh·∫•t 8 k√≠ t·ª±)\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa@\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"Qactive\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra password thi·∫øu k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"userBody\", JSON.stringify({\r",
									"//   username: \"Hoa\",\r",
									"//   password: \"Hoa13hong\",\r",
									"//   role: \"user\",\r",
									"//   fullname: \"Nguy·ªÖn Th·ªã Hoa\",\r",
									"//   email: \"hoanguyen@gmail.com\",\r",
									"//   address: \"H√†n Qu·ªëc\",\r",
									"//   status: \"Qactive\"\r",
									"// }));\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{userBody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete user",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  PARSE JSON AN TO√ÄN\r",
									"// ===============================\r",
									"let body = {};\r",
									"let isJson = true;\r",
									"\r",
									"try {\r",
									"    body = pm.response.json();\r",
									"} catch (e) {\r",
									"    isJson = false;\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", e);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG: TIME, STATUS, CONTENT-TYPE\r",
									"// ===============================\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(`M√£ tr·∫°ng th√°i h·ª£p l·ªá (${statusCode})`, () => {\r",
									"    pm.expect([200, 400, 403, 404, 405]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"const isJsonHeader = contentType.includes(\"application/json\");\r",
									"\r",
									"pm.test(\"Content-Type l√† JSON\", () => {\r",
									"    pm.expect(isJsonHeader).to.be.true;\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 200 (X√ìA TH√ÄNH C√îNG)\r",
									"// ===============================\r",
									"const userIdRaw = pm.request.url.variables.get(\"userId\") || pm.environment.get(\"userId\");\r",
									"const userId = userIdRaw !== null ? String(userIdRaw).trim() : null;\r",
									"\r",
									"if (statusCode === 200 && isJson) {\r",
									"    pm.test(\"Xo√° th√†nh c√¥ng ‚Üí 200 OK\", () => {\r",
									"        pm.expect(body).to.have.property(\"id\");\r",
									"        console.log(\"ƒê√£ xo√° user:\", body.id);\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"if (!userId || userId === \"\" || userId.toLowerCase() === \"null\") {\r",
									"    pm.test(\"userId r·ªóng ho·∫∑c null ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"    });\r",
									"} else if (!/^\\d+$/.test(userId) || /^\\-/.test(userId)) {\r",
									"    pm.test(\"userId sai ƒë·ªãnh d·∫°ng ho·∫∑c s·ªë √¢m ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"    });\r",
									"} else if (statusCode === 400 && isJson && body.message?.includes(\"ƒë√£ unactive\")) {\r",
									"    pm.test(\"User ƒë√£ b·ªã xo√° m·ªÅm tr∆∞·ªõc ƒë√≥ ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(body.message).to.include(\"ƒë√£ unactive\");\r",
									"    });\r",
									"} else if (statusCode === 404 && /^\\d+$/.test(userId)) {\r",
									"    pm.test(\"userId kh√¥ng t·ªìn t·∫°i ‚Üí 404 Not Found\", () => {\r",
									"        pm.expect(body.message?.toLowerCase()).to.include(\"kh√¥ng t√¨m th·∫•y\");\r",
									"    });\r",
									"} else if (statusCode === 403) {\r",
									"    pm.test(\"Kh√¥ng c√≥ quy·ªÅn x√≥a user ‚Üí 403 Forbidden\", () => {\r",
									"        pm.expect(body.message?.toLowerCase()).to.match(/kh√¥ng c√≥ quy·ªÅn|b·ªã t·ª´ ch·ªëi/i);\r",
									"    });\r",
									"} else if ([400, 405].includes(statusCode)) {\r",
									"    pm.test(\"Sai method ho·∫∑c endpoint ‚Üí 400/405\", () => {\r",
									"        console.warn(\"C√≥ th·ªÉ sai method ho·∫∑c sai endpoint URL.\");\r",
									"    });\r",
									"} else if (![200, 400, 403, 404, 405].includes(statusCode)) {\r",
									"    pm.test(\"Tr∆∞·ªùng h·ª£p ph·∫£n h·ªìi kh√¥ng x√°c ƒë·ªãnh\", () => {\r",
									"        pm.expect(isJson).to.be.true;\r",
									"        console.warn(\"Ph·∫£n h·ªìi kh√¥ng r√µ r√†ng:\", body);\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  L·ªñI 401/500\r",
									"// ===============================\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra userId ƒë√∫ng\r",
									"// pm.environment.set(\"userId\", \"8\");\r",
									"// //Ki·ªÉm tra userId null\r",
									"// pm.environment.set(\"userId\", \"null\");\r",
									"// //Ki·ªÉm tra userId r·ªóng\r",
									"// pm.environment.set(\"userId\", \"\");\r",
									"// //Ki·ªÉm tra userId kh√¥ng t√¥ng t·∫°i\r",
									"// pm.environment.set(\"userId\", \"999\");\r",
									"// //Ki·ªÉm tra userId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"userId\", \"abc\");\r",
									"// //Ki·ªÉm tra userId gi√° tr·ªã √¢m\r",
									"// pm.environment.set(\"userId\", \"-1\");\r",
									"// //Ki·ªÉm tra userId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"userId\", \"@\");\r",
									"//Ki·ªÉm tra user userId ƒë√£ b·ªã x√≥a\r",
									"//pm.environment.set(\"userId\", \"8\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/users/{{userId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update user role to admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"const statusCode = pm.response.code;\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  PARSE JSON PH·∫¢N H·ªíI AN TO√ÄN\r",
									"// ===============================\r",
									"let body = {};\r",
									"let isJson = true;\r",
									"try {\r",
									"    body = pm.response.json();\r",
									"} catch (err) {\r",
									"    isJson = false;\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", err);\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG\r",
									"// ===============================\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(`M√£ tr·∫°ng th√°i h·ª£p l·ªá: ${statusCode}`, () => {\r",
									"    pm.expect([200, 400, 401, 403, 404]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType.includes(\"application/json\")).to.be.true;\r",
									"});\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 200 (TH√ÄNH C√îNG)\r",
									"// ===============================\r",
									"const userId = (pm.environment.get(\"userId\") || \"\").trim();\r",
									"if (/^\\d+$/.test(userId) && statusCode === 200 && isJson) {\r",
									"    pm.test(\"C·∫≠p nh·∫≠t th√†nh c√¥ng ‚Üí Vai tr√≤ l√† 'admin'\", () => {\r",
									"        pm.expect(body).to.have.property(\"role\");\r",
									"        pm.expect(body.role).to.eql(\"admin\");\r",
									"        console.log(\"ƒê√£ c·∫≠p nh·∫≠t role:\", body.role);\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"\r",
									"// H√†m helper ki·ªÉm tra message c√≥ ch·ª©a t·ª´ kh√≥a\r",
									"function messageMatches(msg, keywords) {\r",
									"    const lower = (msg || \"\").toLowerCase();\r",
									"    return keywords.some(kw => lower.includes(kw));\r",
									"}\r",
									"\r",
									"// userId r·ªóng ho·∫∑c null\r",
									"if (!userId || userId.toLowerCase() === \"null\") {\r",
									"    pm.test(\"userId null ho·∫∑c r·ªóng ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"        if (isJson) {\r",
									"            pm.expect(messageMatches(body.message, [\"user id\", \"tr·ªëng\", \"thi·∫øu\"])).to.be.true;\r",
									"        }\r",
									"    });\r",
									"}\r",
									"\r",
									"// userId sai ƒë·ªãnh d·∫°ng\r",
									"if (!/^\\d+$/.test(userId)) {\r",
									"    pm.test(\"userId sai ƒë·ªãnh d·∫°ng ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"        if (isJson) {\r",
									"            pm.expect(messageMatches(body.message, [\"ƒë·ªãnh d·∫°ng\", \"sai\", \"kh√¥ng h·ª£p l·ªá\", \"k√Ω t·ª±\"])).to.be.true;\r",
									"        }\r",
									"    });\r",
									"}\r",
									"\r",
									"// userId l√† s·ªë √¢m\r",
									"if (/^-\\d+$/.test(userId)) {\r",
									"    pm.test(\"userId l√† s·ªë √¢m ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"        if (isJson) {\r",
									"            pm.expect(messageMatches(body.message, [\"√¢m\", \"s·ªë √¢m\", \"kh√¥ng h·ª£p l·ªá\"])).to.be.true;\r",
									"        }\r",
									"    });\r",
									"}\r",
									"\r",
									"// User ƒë√£ b·ªã unactive\r",
									"if (statusCode === 400 && isJson && messageMatches(body.message, [\"unactive\", \"v√¥ hi·ªáu\", \"ƒë√£ x√≥a\"])) {\r",
									"    pm.test(\"User ƒë√£ b·ªã xo√° m·ªÅm ‚Üí 400 Bad Request\", () => {\r",
									"        pm.expect(statusCode).to.eql(400);\r",
									"        console.warn(\"User b·ªã xo√° m·ªÅm:\", userId);\r",
									"    });\r",
									"}\r",
									"\r",
									"// Kh√¥ng c√≥ quy·ªÅn (401 ho·∫∑c 403)\r",
									"if ([401, 403].includes(statusCode)) {\r",
									"    pm.test(`Kh√¥ng c√≥ quy·ªÅn c·∫≠p nh·∫≠t ‚Üí ${statusCode}`, () => {\r",
									"        pm.expect([401, 403]).to.include(statusCode);\r",
									"        if (isJson) {\r",
									"            pm.expect(messageMatches(body.message, [\r",
									"                \"kh√¥ng c√≥ quy·ªÅn\", \"unauthorized\", \"forbidden\",\r",
									"                \"kh√¥ng th·ªÉ c·∫≠p nh·∫≠t\", \"b·ªã t·∫°m kh√≥a\", \"b·ªã kh√≥a\", \"truy c·∫≠p b·ªã t·ª´ ch·ªëi\"\r",
									"            ])).to.be.true;\r",
									"        }\r",
									"        console.warn(\"Quy·ªÅn b·ªã t·ª´ ch·ªëi:\", statusCode);\r",
									"    });\r",
									"}\r",
									"\r",
									"// userId kh√¥ng t·ªìn t·∫°i\r",
									"if (/^\\d+$/.test(userId) && statusCode === 404 && isJson) {\r",
									"    pm.test(\"userId kh√¥ng t·ªìn t·∫°i ‚Üí 404 Not Found\", () => {\r",
									"        pm.expect(messageMatches(body.message, [\"kh√¥ng t√¨m th·∫•y\", \"not found\"])).to.be.true;\r",
									"        console.warn(\"Kh√¥ng t√¨m th·∫•y user:\", userId);\r",
									"    });\r",
									"}\r",
									"\r",
									"// Tr∆∞·ªùng h·ª£p kh√¥ng x√°c ƒë·ªãnh r√µ\r",
									"if (![200, 400, 401, 403, 404].includes(statusCode)) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi kh√¥ng r√µ r√†ng\", () => {\r",
									"        pm.expect(isJson).to.be.true;\r",
									"        console.warn(\"Kh√¥ng r√µ l√Ω do l·ªói:\", body);\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"// ===============================\r",
									"//  TH√îNG B√ÅO CHO 401 V√Ä 500\r",
									"// ===============================\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra userId ƒë√∫ng\r",
									"pm.environment.set(\"userId\", \"8\");\r",
									"// //Ki·ªÉm tra userId null\r",
									"// pm.environment.set(\"userId\", \"null\");\r",
									"// //Ki·ªÉm tra userId r·ªóng\r",
									"//pm.environment.set(\"userId\", \"\");\r",
									"// //Ki·ªÉm tra userId kh√¥ng t√¥ng t·∫°i\r",
									"// pm.environment.set(\"userId\", \"999\");\r",
									"// //Ki·ªÉm tra userId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"userId\", \"abc\");\r",
									"// //Ki·ªÉm tra userId gi√° tr·ªã √¢m\r",
									"//pm.environment.set(\"userId\", \"-1\");\r",
									"// //Ki·ªÉm tra userId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"//pm.environment.set(\"userId\", \"@\");\r",
									"// //Ki·ªÉm tra userId ƒë√£ b·ªã unactive kh√¥ng c·∫≠p nh·∫≠t ƒë∆∞·ª£c\r",
									" //pm.environment.set(\"userId\", \"10\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"role\": \"admin\"\r\n}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/users/{{userId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Search users",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"const statusCode = pm.response.code;\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\"fake-admin-token-999\", \"fake-user-token-123\"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let resData;\r",
									"let isJson = false;\r",
									"\r",
									"try {\r",
									"    resData = pm.response.json();\r",
									"    isJson = true;\r",
									"} catch (err) {\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", err);\r",
									"}\r",
									"\r",
									"if (!isJson) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng parse ƒë∆∞·ª£c JSON.\");\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG: TIME, STATUS, CONTENT-TYPE\r",
									"// ===============================\r",
									"pm.test(\"Th·ªùi gian ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"    pm.expect(contentType.toLowerCase()).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"const stringFields = [\"username\", \"role\", \"fullName\", \"email\", \"address\", \"statusName_user\"];\r",
									"const normalize = (str) => str.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\").replace(/[^a-z0-9]/g, \"\");\r",
									"const partialMatch = (actual, expected) => normalize(actual).includes(normalize(expected));\r",
									"\r",
									"// L·∫•y d·ªØ li·ªáu t·ª´ environment\r",
									"const envValues = {};\r",
									"stringFields.forEach(field => {\r",
									"    const val = pm.environment.get(field);\r",
									"    if (val && val.trim().toLowerCase() !== \"null\") {\r",
									"        envValues[field] = val.trim();\r",
									"    }\r",
									"});\r",
									"\r",
									"// Ki·ªÉm tra ƒë·ªãnh d·∫°ng kh√¥ng h·ª£p l·ªá\r",
									"const isInvalidInput = (field, value) => {\r",
									"    if (!value) return true;\r",
									"    const val = value.trim().toLowerCase();\r",
									"    return (\r",
									"        val === \"\" ||\r",
									"        val === \"null\" ||\r",
									"        /^[\\W_]+$/.test(val) ||\r",
									"        /^\\d+$/.test(val) ||\r",
									"        (field === \"role\" && ![\"user\", \"admin\"].includes(val)) ||\r",
									"        (field === \"statusName_user\" && ![\"active\", \"unactive\"].includes(val))\r",
									"    );\r",
									"};\r",
									"\r",
									"if (statusCode === 200 && Array.isArray(resData)) {\r",
									"    const invalidInputs = Object.entries(envValues).filter(([field, value]) => isInvalidInput(field, value));\r",
									"\r",
									"    if (invalidInputs.length > 0) {\r",
									"        invalidInputs.forEach(([field, value]) => {\r",
									"            pm.test(`'${field}' = '${value}' sai ƒë·ªãnh d·∫°ng nh∆∞ng v·∫´n tr·∫£ 200`, () => {\r",
									"                pm.expect.fail(`Tr∆∞·ªùng '${field}' = '${value}' sai ƒë·ªãnh d·∫°ng nh∆∞ng API v·∫´n tr·∫£ 200`);\r",
									"            });\r",
									"        });\r",
									"    }\r",
									"\r",
									"    pm.test(\"Response l√† m·∫£ng\", () => {\r",
									"        pm.expect(Array.isArray(resData)).to.be.true;\r",
									"    });\r",
									"\r",
									"    if (resData.length === 0) {\r",
									"        if (invalidInputs.length === 0 && Object.keys(envValues).length > 0) {\r",
									"            pm.test(\"M·∫£ng r·ªóng nh∆∞ng kh√¥ng tr·∫£ v·ªÅ 404\", () => {\r",
									"                pm.expect.fail(\"Input h·ª£p l·ªá nh∆∞ng kh√¥ng c√≥ k·∫øt qu·∫£ ‚Üí n√™n tr·∫£ 404 thay v√¨ 200 + []\");\r",
									"            });\r",
									"        } else {\r",
									"            pm.test(\"Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o (m·∫£ng r·ªóng)\", () => {\r",
									"                pm.expect(resData.length).to.eql(0);\r",
									"            });\r",
									"        }\r",
									"\r",
									"        Object.entries(envValues).forEach(([field, value]) => {\r",
									"            const likelyFail = normalize(value) !== value.toLowerCase().replace(/\\s+/g, \"\");\r",
									"            if (likelyFail) {\r",
									"                pm.test(`C√≥ th·ªÉ backend kh√¥ng normalize tr∆∞·ªùng '${field}'`, () => {\r",
									"                    pm.expect.fail(`Gi√° tr·ªã '${value}' c√≥ th·ªÉ ƒëang b·ªã ph√¢n bi·ªát d·∫•u/k√Ω t·ª±/HOA th∆∞·ªùng`);\r",
									"                });\r",
									"            }\r",
									"        });\r",
									"    } else {\r",
									"        const user = resData[0];\r",
									"\r",
									"        Object.entries(envValues).forEach(([field, expected]) => {\r",
									"            if (user[field]) {\r",
									"                pm.test(`'${field}' ch·ª©a '${expected}'`, () => {\r",
									"                    pm.expect(partialMatch(user[field], expected)).to.be.true;\r",
									"                });\r",
									"            } else {\r",
									"                pm.test(`Kh√¥ng c√≥ tr∆∞·ªùng '${field}' trong k·∫øt qu·∫£`, () => {\r",
									"                    console.warn(\"Tr∆∞·ªùng thi·∫øu:\", field);\r",
									"                });\r",
									"            }\r",
									"        });\r",
									"\r",
									"        if (user.email) {\r",
									"            pm.test(\"Email ƒë√∫ng ƒë·ªãnh d·∫°ng\", () => {\r",
									"                const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r",
									"                pm.expect(emailRegex.test(user.email)).to.be.true;\r",
									"            });\r",
									"        }\r",
									"    }\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù STATUS KH√ÅC\r",
									"// ===============================\r",
									"const msg = (resData.message || \"\").toLowerCase();\r",
									"\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\"400 - Input kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"\r",
									"    Object.entries(envValues).forEach(([field, value]) => {\r",
									"        if (isInvalidInput(field, value)) {\r",
									"            pm.test(`'${field}' sai ƒë·ªãnh d·∫°ng v√† ƒë√£ tr·∫£ v·ªÅ 400`, () => {\r",
									"                pm.expect(statusCode).to.eql(400);\r",
									"            });\r",
									"        }\r",
									"    });\r",
									"}\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 403) {\r",
									"    pm.test(\"403 - Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p\", () => {\r",
									"        pm.expect(msg).to.match(/kh√¥ng c√≥ quy·ªÅn|forbidden|unauthorized/);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 404) {\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu\", () => {\r",
									"        pm.expect(msg).to.match(/kh√¥ng t√¨m th·∫•y|not found/);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói m√°y ch·ªß\", () => {\r",
									"        pm.expect(msg).to.match(/l·ªói|error|exception/);\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //=========USERNAME==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra username gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"null\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra username th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"Trang\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"//Ki·ªÉm tra username ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"123\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra username c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"username\", \"@\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //PASSWORD kh√¥ng ƒë∆∞·ª£c ph√©p t√¨m ki·∫øm\r",
									"\r",
									"// // //=========ROLE==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra role gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"null\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra role th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"user\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra role ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"123\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra role c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"@\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// // Ki·ªÉm tra role c√≥ gi√° tr·ªã kh√°c user ho·∫∑c admin\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"usera\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"\r",
									"// //=========FULLNAME==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra fullName gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"null\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"//Ki·ªÉm tra fullName th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \" Nguy·ªÖn Trang\");//pm.environment.set(\"fullName\", \"Nguy·ªÖn\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra fullName ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"123\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"//Ki·ªÉm tra fullName c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"@\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"\r",
									"// //=========EMAIL==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra email gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"null\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra email th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"hautran@gmail.com\");//pm.environment.set(\"email\", \"@gmail.com\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra email ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"123\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"\r",
									"// //=========ADDRESS==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra address gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"null\");\r",
									"// //Ki·ªÉm tra address th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"Vi·ªát Nam\");//pm.environment.set(\"address\", \"Vi·ªát\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra address ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"123\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra address c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"@\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"\r",
									"// //=========STATUS==========//\r",
									"// // Ki·ªÉm tra username,role,fullName,email,address,status kh√¥ng c√≥ gi√° tr·ªã\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"\");\r",
									"// //Ki·ªÉm tra statusName_user gi√° tr·ªã null\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"null\");\r",
									"// //Ki·ªÉm tra statusName_user th√†nh c√¥ng\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"status\", \"active\");\r",
									"// //Ki·ªÉm tra statusName_user ƒë·ªãnh d·∫°ng sai\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"123\");\r",
									"// //Ki·ªÉm tra statusName_user c√≥ k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"@\");\r",
									"// //Ki·ªÉm tra statusName_user c√≥ gi√° tr·ªã kh√°c active ho·∫∑c unactive\r",
									"// pm.environment.set(\"username\", \"\");\r",
									"// pm.environment.set(\"role\", \"\");\r",
									"// pm.environment.set(\"fullName\", \"\");\r",
									"// pm.environment.set(\"email\", \"\");\r",
									"// pm.environment.set(\"address\", \"\");\r",
									"// pm.environment.set(\"statusName_user\", \"inactive\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/users?status={{statusName_user}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users"
							],
							"query": [
								{
									"key": "status",
									"value": "{{statusName_user}}"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders",
			"item": [
				{
					"name": "Place a new book order",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"//===================TR∆∞·ªùng h·ª£p bookId lu√¥n ƒë√∫ng============\r",
									"// // //Ki·ªÉm tra bookId ƒë√∫ng, userId ƒë√∫ng\r",
									" pm.environment.set(\"bookId\", \"1\"); \r",
									" pm.environment.set(\"userId\", \"2\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId null\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"null\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId r·ªóng\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"abc\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"999\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId l√† k√≠ t·ª± d·∫∑c bi·ªát\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"@\");\r",
									"// //Ki·ªÉm tra bookId ƒë√∫ng, userId l√† s·ªë √¢m\r",
									"// pm.environment.set(\"bookId\", \"1\"); \r",
									"// pm.environment.set(\"userId\", \"-1\");\r",
									"// //===================TR∆∞·ªùng h·ª£p userID lu√¥n ƒë√∫ng============\r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId null\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"// pm.environment.set(\"bookId\", \"null\"); \r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId r·ªóng\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"//  pm.environment.set(\"bookId\", \"\"); \r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"// pm.environment.set(\"bookId\", \"abc\"); \r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"// pm.environment.set(\"bookId\", \"@\"); \r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"//  pm.environment.set(\"bookId\", \"999\"); \r",
									"// //Ki·ªÉm tra userId ƒë√∫ng v√† bookId s·ªë √¢m\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"//  pm.environment.set(\"bookId\", \"-1\"); \r",
									"\r",
									"// L·∫•y c√°c gi√° tr·ªã t·ª´ bi·∫øn m√¥i tr∆∞·ªùng\r",
									"const userId = parseInt(pm.environment.get(\"userId\"));\r",
									"const bookId = pm.environment.get(\"bookId\");\r",
									"const createdAt = pm.environment.get(\"isoDate\") || new Date().toISOString();\r",
									"const shippingMethod = \"standard\"; // ho·∫∑c l·∫•y t·ª´ bi·∫øn n·∫øu c·∫ßn\r",
									"\r",
									"// T·∫°o payload\r",
									"const orderPayload = {\r",
									"  userId,\r",
									"  items: [\r",
									"    {\r",
									"      bookId,\r",
									"      quantity: 1\r",
									"    }\r",
									"  ],\r",
									"  createdAt,\r",
									"  shippingMethod\r",
									"};\r",
									"\r",
									"// Set payload v√†o bi·∫øn m√¥i tr∆∞·ªùng\r",
									"pm.environment.set(\"orderPayload\", JSON.stringify(orderPayload));\r",
									"\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"// . KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\"fake-admin-token-999\", \"fake-user-token-123\"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let resData = {};\r",
									"let isJson = false;\r",
									"\r",
									"try {\r",
									"    resData = pm.response.json();\r",
									"    isJson = true;\r",
									"} catch (err) {\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", err);\r",
									"}\r",
									"\r",
									"if (!isJson) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng parse ƒë∆∞·ª£c JSON.\");\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG: STATUS, TIME, CONTENT-TYPE\r",
									"// ===============================\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 201, 400, 401, 403, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"    pm.expect(contentType.toLowerCase()).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 201 - T·∫†O ƒê∆†N H√ÄNG\r",
									"// ===============================\r",
									"const expectedUserId = parseInt(pm.environment.get(\"userId\"));\r",
									"const expectedBookId = pm.environment.get(\"bookId\");\r",
									"\r",
									"if (statusCode === 201 && isJson) {\r",
									"    pm.test(\"Status 201 - T·∫°o ƒë∆°n h√†ng th√†nh c√¥ng\", () => {\r",
									"        pm.expect(statusCode).to.eql(201);\r",
									"    });\r",
									"\r",
									"    pm.test(\"userId h·ª£p l·ªá v√† tr√πng v·ªõi bi·∫øn m√¥i tr∆∞·ªùng\", () => {\r",
									"        pm.expect(resData).to.have.property(\"userId\").that.eql(expectedUserId);\r",
									"    });\r",
									"\r",
									"    pm.test(\"shippingMethod h·ª£p l·ªá\", () => {\r",
									"        pm.expect(resData).to.have.property(\"shippingMethod\").that.is.oneOf([\"standard\", \"express\"]);\r",
									"    });\r",
									"\r",
									"    pm.test(\"createdAt ƒë√∫ng ƒë·ªãnh d·∫°ng ISO\", () => {\r",
									"        pm.expect(resData).to.have.property(\"createdAt\");\r",
									"        pm.expect(Date.parse(resData.createdAt)).to.not.be.NaN;\r",
									"    });\r",
									"\r",
									"    pm.test(\"items l√† m·∫£ng h·ª£p l·ªá v√† c√≥ √≠t nh·∫•t 1 ph·∫ßn t·ª≠\", () => {\r",
									"        pm.expect(resData).to.have.property(\"items\").that.is.an(\"array\").that.is.not.empty;\r",
									"    });\r",
									"\r",
									"    resData.items.forEach((item, index) => {\r",
									"        pm.test(`Item ${index + 1} h·ª£p l·ªá`, () => {\r",
									"            pm.expect(item).to.have.property(\"bookId\").that.eql(expectedBookId);\r",
									"            pm.expect(item).to.have.property(\"quantity\").that.is.a(\"number\").and.above(0);\r",
									"        });\r",
									"    });\r",
									"\r",
									"    if (resData.id) {\r",
									"        pm.environment.set(\"orderId\", resData.id);\r",
									"        console.log(\"ƒê√£ l∆∞u orderId:\", resData.id);\r",
									"    }\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù C√ÅC L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"const msg = (resData.message || \"\").toLowerCase();\r",
									"\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\"400 - L·ªói do ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg.length).to.be.above(0);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Th√¥ng b√°o l·ªói li√™n quan ƒë·∫øn d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg).to.match(/bookid|userid|invalid|null|kh√¥ng h·ª£p l·ªá/i);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c\", () => {\r",
									"        pm.expect(msg).to.match(/unauthorized|unauthenticated/i);\r",
									"    });\r",
									"\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá ho·∫∑c thi·∫øu quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 403) {\r",
									"    pm.test(\"403 - Kh√¥ng c√≥ quy·ªÅn truy c·∫≠p\", () => {\r",
									"        pm.expect(msg).to.match(/forbidden|kh√¥ng c√≥ quy·ªÅn/i);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 404) {\r",
									"    pm.test(\"404 - Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu\", () => {\r",
									"        pm.expect(msg).to.match(/not found|kh√¥ng t√¨m th·∫•y/i);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói m√°y ch·ªß\", () => {\r",
									"        pm.expect(msg).to.match(/l·ªói|error|exception/i);\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer  {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "// {\r\n//   \"userId\":99 ,\r\n//   \"items\": [\r\n//     {\r\n//       \"bookId\": \"{{bookId}}\",\r\n//       \"quantity\": 1\r\n//     }\r\n//   ],\r\n//   \"createdAt\": \"{{isoDate}}\",\r\n//   \"shippingMethod\": \"standard\"\r\n// }\r\n// {{orderPayload}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/orders",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get all orders",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const statusCode = pm.response.code;\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\"Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ===============================\r",
									"let resData;\r",
									"let isJson = false;\r",
									"\r",
									"try {\r",
									"    resData = pm.response.json();\r",
									"    isJson = true;\r",
									"} catch (err) {\r",
									"    console.warn(\"Kh√¥ng parse ƒë∆∞·ª£c JSON:\", err);\r",
									"}\r",
									"\r",
									"if (!isJson) {\r",
									"    pm.test(\"Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect.fail(\"Ph·∫£n h·ªìi kh√¥ng parse ƒë∆∞·ª£c JSON.\");\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  TEST CHUNG: STATUS, TIME, CONTENT-TYPE\r",
									"// ===============================\r",
									"console.log(`Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"pm.test(\"Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\"Content-Type l√† application/json\", () => {\r",
									"    const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"    pm.expect(contentType).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"pm.test(\"Status code l√† 200\", () => {\r",
									"    pm.expect(statusCode).to.eql(200);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  LOGIC KHI STATUS = 200\r",
									"// ===============================\r",
									"if (statusCode === 200 && Array.isArray(resData)) {\r",
									"    pm.test(\"D·ªØ li·ªáu tr·∫£ v·ªÅ l√† m·∫£ng c√°c ƒë∆°n h√†ng\", () => {\r",
									"        pm.expect(resData).to.be.an(\"array\");\r",
									"        pm.expect(resData.length).to.be.above(0);\r",
									"    });\r",
									"\r",
									"    pm.test(\"M·ªói ƒë∆°n h√†ng c√≥ ƒë·∫ßy ƒë·ªß thu·ªôc t√≠nh c·∫ßn thi·∫øt\", () => {\r",
									"        resData.forEach(order => {\r",
									"            pm.expect(order).to.have.property(\"id\").that.is.a(\"string\");\r",
									"            pm.expect(order).to.have.property(\"userId\").that.is.a(\"number\");\r",
									"            pm.expect(order).to.have.property(\"items\").that.is.an(\"array\");\r",
									"            pm.expect(order).to.have.property(\"createdAt\").that.is.a(\"string\");\r",
									"            pm.expect(order).to.have.property(\"role\").that.is.a(\"string\");\r",
									"\r",
									"            order.items.forEach(item => {\r",
									"                pm.expect(item).to.have.property(\"bookId\").that.is.a(\"string\");\r",
									"                pm.expect(item).to.have.property(\"quantity\").that.is.a(\"number\");\r",
									"            });\r",
									"        });\r",
									"    });\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  X·ª¨ L√ù C√ÅC L·ªñI KH√ÅC\r",
									"// ===============================\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\"401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\"500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\"C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "http://bookstore-api-tests.onrender.com/orders",
							"protocol": "http",
							"host": [
								"bookstore-api-tests",
								"onrender",
								"com"
							],
							"path": [
								"orders"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Reviews",
			"item": [
				{
					"name": "Get all reviews for book ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ==============================\r",
									"//  KI·ªÇM TRA AUTHORIZATION\r",
									"// ==============================\r",
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"// Token nghi gi·∫£\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"// Danh s√°ch token gi·∫£ ƒë∆∞·ª£c ch·∫•p nh·∫≠n khi test\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"// ‚ùå N·∫øu token sai m√† v·∫´n tr·∫£ v·ªÅ 200 ‚Üí c·∫£nh b√°o\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\" Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"\r",
									"// ==============================\r",
									"//  KI·ªÇM TRA PH·∫¢N H·ªíI JSON\r",
									"// ==============================\r",
									"let json;\r",
									"let isJsonValid = true;\r",
									"try {\r",
									"    json = pm.response.json();\r",
									"} catch (err) {\r",
									"    isJsonValid = false;\r",
									"    json = null;\r",
									"    console.error(\"‚ùå Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON h·ª£p l·ªá.\");\r",
									"}\r",
									"\r",
									"pm.test(\" Ph·∫£n h·ªìi l√† JSON h·ª£p l·ªá\", () => {\r",
									"    pm.expect(isJsonValid).to.be.true;\r",
									"});\r",
									"\r",
									"\r",
									"// ==============================\r",
									"// üß™ TEST CHUNG CHO STATUS CODE, TIME, CONTENT-TYPE\r",
									"// ==============================\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"\r",
									"pm.test(\" M√£ tr·∫°ng th√°i h·ª£p l·ªá\", () => {\r",
									"    pm.expect([200, 400, 401, 404, 500]).to.include(statusCode);\r",
									"});\r",
									"\r",
									"pm.test(\" Ph·∫£n h·ªìi nhanh d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"pm.test(\" Content-Type l√† application/json\", () => {\r",
									"    pm.expect(contentType.toLowerCase()).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"\r",
									"// ==============================\r",
									"//  KI·ªÇM TRA QUERY PARAM bookId\r",
									"// ==============================\r",
									"const queryKeys = pm.request.url.query.map(q => q.key.toLowerCase());\r",
									"const expectedParam = \"bookid\";\r",
									"const hasCorrectParam = queryKeys.includes(expectedParam);\r",
									"const bookId = pm.request.url.query.find(q => q.key.toLowerCase() === expectedParam)?.value;\r",
									"\r",
									"function isInvalidBookId(id) {\r",
									"    return (\r",
									"        !id ||\r",
									"        id.trim() === \"\" ||\r",
									"        isNaN(Number(id)) ||\r",
									"        Number(id) <= 0 ||\r",
									"        /[^a-zA-Z0-9]/.test(id)\r",
									"    );\r",
									"}\r",
									"\r",
									"pm.test(\" C√≥ param 'bookId' h·ª£p l·ªá khi g·ªçi API\", () => {\r",
									"    if (!hasCorrectParam && statusCode === 200) {\r",
									"        pm.expect.fail(` Thi·∫øu ho·∫∑c sai t√™n query param 'bookId', nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200!`);\r",
									"    } else {\r",
									"        pm.expect(hasCorrectParam).to.be.true;\r",
									"    }\r",
									"});\r",
									"\r",
									"\r",
									"// ==============================\r",
									"//  LOGIC KHI STATUS = 200\r",
									"// ==============================\r",
									"if (statusCode === 200 && isJsonValid) {\r",
									"    pm.test(\" 200 - Th√†nh c√¥ng v√† tr·∫£ v·ªÅ m·∫£ng\", () => {\r",
									"        pm.expect(Array.isArray(json)).to.be.true;\r",
									"    });\r",
									"\r",
									"    if (json.length === 0) {\r",
									"        if (isInvalidBookId(bookId)) {\r",
									"            pm.test(\"Sai: bookId kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"                pm.expect.fail(`bookId = \"${bookId}\" l√† kh√¥ng h·ª£p l·ªá, nh∆∞ng API tr·∫£ v·ªÅ 200`);\r",
									"            });\r",
									"        } else {\r",
									"            pm.test(\"‚Ñπ Kh√¥ng c√≥ review n√†o cho bookId h·ª£p l·ªá\", () => {\r",
									"                pm.expect(json.length).to.eql(0);\r",
									"            });\r",
									"        }\r",
									"    } else {\r",
									"        const review = json[0];\r",
									"\r",
									"        pm.test(\" Review ƒë·∫ßu ti√™n c√≥ ƒë·ªß tr∆∞·ªùng\", () => {\r",
									"            pm.expect(review).to.have.all.keys(\"id\", \"bookId\", \"userId\", \"rating\", \"comment\", \"createdAt\");\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ki·ªÉu d·ªØ li·ªáu c√°c tr∆∞·ªùng ƒë√∫ng\", () => {\r",
									"            pm.expect([\"string\", \"number\"]).to.include(typeof review.id);\r",
									"            pm.expect([\"string\", \"number\"]).to.include(typeof review.bookId);\r",
									"            pm.expect(review.userId).to.be.a(\"number\");\r",
									"            pm.expect(review.rating).to.be.a(\"number\");\r",
									"            pm.expect(review.comment).to.be.a(\"string\");\r",
									"            pm.expect(isNaN(Date.parse(review.createdAt))).to.be.false;\r",
									"        });\r",
									"\r",
									"        pm.test(` T·∫•t c·∫£ reviews c√≥ bookId = \"${bookId}\"`, () => {\r",
									"            json.forEach(r => {\r",
									"                pm.expect(String(r.bookId)).to.eql(bookId);\r",
									"            });\r",
									"        });\r",
									"\r",
									"        // L∆∞u l·∫°i reviewId cho request sau\r",
									"        pm.environment.set(\"reviewId\", review.id);\r",
									"        console.log(\" ƒê√£ l∆∞u reviewId:\", review.id);\r",
									"    }\r",
									"}\r",
									"\r",
									"\r",
									"// ==============================\r",
									"//  X·ª¨ L√ù TR∆Ø·ªúNG H·ª¢P L·ªñI KH√ÅC\r",
									"// ==============================\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\" 400 - D·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\" bookId c√≥ th·ªÉ r·ªóng, null, sai ƒë·ªãnh d·∫°ng, √¢m, k√Ω t·ª± ƒë·∫∑c bi·ªát,‚Ä¶\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 404) {\r",
									"    pm.test(\"‚ùå 404 - Kh√¥ng t√¨m th·∫•y s√°ch\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(` bookId \"${bookId}\" kh√¥ng t·ªìn t·∫°i trong h·ªá th·ªëng`);\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 401) {\r",
									"    pm.test(\" 401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\" C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"    });\r",
									"}\r",
									"\r",
									"if (statusCode === 500) {\r",
									"    pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"        pm.expect(true).to.be.true;\r",
									"        console.warn(\" C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"    });\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra bookId ƒë√∫ng\r",
									"//pm.environment.set(\"bookId\", \"1\"); \r",
									" \r",
									"// //Ki·ªÉm tra bookId null\r",
									" //pm.environment.set(\"bookId\", \"null\"); \r",
									"\r",
									"// //Ki·ªÉm tra bookId r·ªóng\r",
									"//pm.environment.set(\"bookId\", \"\"); \r",
									"\r",
									"// //Ki·ªÉm tra bookId sai ƒë·ªãnh d·∫°ng\r",
									"//pm.environment.set(\"bookId\", \"abc\");\r",
									"\r",
									"// //Ki·ªÉm tra bookId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"//pm.environment.set(\"bookId\", \"@\"); \r",
									"\r",
									"// //Ki·ªÉm tra bookId kh√¥ng t·ªìn t·∫°i\r",
									"//pm.environment.set(\"bookId\", \"999\"); \r",
									" \r",
									"// //Ki·ªÉm tra bookId s·ªë √¢m\r",
									"//  pm.environment.set(\"bookId\", \"-1\"); \r",
									"\r",
									"//pm.environment.set(\"admin_token\",\"fake-admin-token-9\");\r",
									"//pm.environment.set(\"admin_token\",\"fake-admin-token-999\");\r",
									"\r",
									"\r",
									"//pm.environment.set(\"user_token\",\"fake-user-token-9\");\r",
									"//pm.environment.set(\"user_token\",\"fake-user-token-999\");"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/reviews?bookId={{bookId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"reviews"
							],
							"query": [
								{
									"key": "bookId",
									"value": "{{bookId}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Add a new review for a book",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// const iso = new Date().toISOString();\r",
									"// pm.environment.set(\"isoDate\", iso);\r",
									"// console.log(\" ISO Date:\", iso);\r",
									"//Ki·ªÉm tra bookId, userId,rating, comment, createdAt h·ª£p l·ªá\r",
									"pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"  bookId: \"66\",\r",
									"  userId: 6,\r",
									"  rating: 3,\r",
									"  comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"  createdAt: \"{{isoDate}}\"\r",
									"}));\r",
									"// //Ki·ªÉm tra bookId kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"999\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra bookId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"abc\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra bookId tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra bookId gi√° tr·ªã null\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: null,\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra userId kh√¥ng t·ªìn t·∫°i\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 999,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra userId tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: \"\",\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra userId sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: \"abc\",\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// Ki·ªÉm tra userId null\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: null,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"//Ki·ªÉm tra rating kh√¥ng h·ª£p l·ªá\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 6,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: \"\",\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"//Ki·ªÉm tra rating sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: \"abc\",\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"//   }));\r",
									"// //Ki·ªÉm tra rating kh√¥ng h·ª£p l·ªá\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 6,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: \"\",\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra rating sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: \"abc\",\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra rating null\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: null,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"//Ki·ªÉm tra rating l·ªõn h∆°n 5\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 6,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// Ki·ªÉm tra rating nh·ªè h∆°n 1\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 0,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"\r",
									"// //Ki·ªÉm tra comment tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"//Ki·ªÉm tra comment sai ƒë·ªãnh d·∫°ng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: 123,\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra comment tr·ªëng\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// //Ki·ªÉm ta comment null\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"null\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));\r",
									"// Ki·ªÉm tra t·∫°o review thi·∫øu tr∆∞·ªùng bookId,userId,rating,comment,createdAt\r",
									"// pm.environment.set(\"reviewBody\", JSON.stringify({\r",
									"//   bookId: \"6\",\r",
									"//   userId: 6,\r",
									"//   rating: 3,\r",
									"//   comment: \"S√°ch cu·ªën r·∫•t\",\r",
									"//   createdAt: \"{{isoDate}}\"\r",
									"// }));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"//   KI·ªÇM TRA AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\"fake-admin-token-999\", \"fake-user-token-123\"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"‚ùå Token kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//   KI·ªÇM TRA PH·∫¢N H·ªíI CHUNG\r",
									"// ===============================\r",
									"pm.test(\" Ph·∫£n h·ªìi d∆∞·ªõi 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"});\r",
									"\r",
									"const contentType = pm.response.headers.get(\"Content-Type\") || \"\";\r",
									"pm.test(\" Content-Type l√† JSON\", () => {\r",
									"    pm.expect(contentType.toLowerCase()).to.include(\"application/json\");\r",
									"});\r",
									"\r",
									"let reviewBody = {};\r",
									"try {\r",
									"    reviewBody = JSON.parse(pm.environment.get(\"reviewBody\") || \"{}\");\r",
									"} catch (e) {\r",
									"    console.warn(\"‚ö†Ô∏è Kh√¥ng parse ƒë∆∞·ª£c reviewBody t·ª´ environment\");\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//   X·ª¨ L√ù STATUS = 201 (TH√ÄNH C√îNG)\r",
									"// ===============================\r",
									"if (statusCode === 201) {\r",
									"    let review;\r",
									"    try {\r",
									"        review = pm.response.json();\r",
									"    } catch (e) {\r",
									"        pm.test(\"‚ùå Ph·∫£n h·ªìi kh√¥ng ph·∫£i JSON\", () => {\r",
									"            throw new Error(\"Kh√¥ng parse ƒë∆∞·ª£c JSON t·ª´ ph·∫£n h·ªìi\");\r",
									"        });\r",
									"        return;\r",
									"    }\r",
									"\r",
									"    pm.test(\" Review c√≥ ƒë·ªß c√°c tr∆∞·ªùng b·∫Øt bu·ªôc\", () => {\r",
									"        [\"id\", \"bookId\", \"userId\", \"rating\", \"comment\", \"createdAt\"].forEach(field => {\r",
									"            pm.expect(review).to.have.property(field);\r",
									"        });\r",
									"    });\r",
									"\r",
									"    pm.test(\" Ki·ªÉu d·ªØ li·ªáu t·ª´ng tr∆∞·ªùng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(review.id).to.satisfy(id => typeof id === 'string' || typeof id === 'number');\r",
									"        pm.expect(review.bookId).to.satisfy(id => typeof id === 'string' || typeof id === 'number');\r",
									"        pm.expect(review.userId).to.be.a(\"number\");\r",
									"        pm.expect(review.rating).to.be.a(\"number\");\r",
									"        pm.expect(review.comment).to.be.a(\"string\");\r",
									"        pm.expect(Date.parse(review.createdAt)).to.not.be.NaN;\r",
									"    });\r",
									"\r",
									"    pm.test(\" Rating n·∫±m trong kho·∫£ng 1‚Äì5\", () => {\r",
									"        pm.expect(review.rating).to.be.within(1, 5);\r",
									"    });\r",
									"\r",
									"    pm.environment.set(\"reviewId\", review.id);\r",
									"    console.log(\" ƒê√£ l∆∞u reviewId:\", review.id);\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//   X·ª¨ L√ù STATUS = 400 / 401 / 404 / 500\r",
									"// ===============================\r",
									"else if ([400, 401, 404, 500].includes(statusCode)) {\r",
									"    let responseJson = {};\r",
									"    let isJson = true;\r",
									"\r",
									"    try {\r",
									"        responseJson = pm.response.json();\r",
									"    } catch (e) {\r",
									"        isJson = false;\r",
									"        console.warn(\" Kh√¥ng parse ƒë∆∞·ª£c JSON t·ª´ ph·∫£n h·ªìi l·ªói\");\r",
									"    }\r",
									"\r",
									"    pm.test(\" Ph·∫£n h·ªìi l·ªói l√† JSON h·ª£p l·ªá\", () => {\r",
									"        pm.expect(isJson).to.be.true;\r",
									"    });\r",
									"\r",
									"    if (!isJson) return;\r",
									"\r",
									"    const msg = (responseJson.message || \"\").toLowerCase();\r",
									"\r",
									"   // ===============================\r",
									"// ===============================\r",
									"//   STATUS 400 - Bad Request\r",
									"// ===============================\r",
									"if (statusCode === 400) {\r",
									"    pm.test(\" 400 - D·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá\", () => {\r",
									"        pm.expect(msg).to.match(/invalid|null|bad request|kh√¥ng h·ª£p l·ªá|tr∆∞·ªùng b·∫Øt bu·ªôc|nguy√™n d∆∞∆°ng|kh√¥ng t·ªìn t·∫°i|rating ph·∫£i l√† s·ªë t·ª´ 1 ƒë·∫øn 5|kho·∫£ng tr·∫Øng/);\r",
									"    });\r",
									"\r",
									"    const { bookId, userId, rating, comment } = reviewBody;\r",
									"\r",
									"    // Bi·ªÉu th·ª©c ki·ªÉm tra k√Ω t·ª± ƒë·∫∑c bi·ªát kh√¥ng h·ª£p l·ªá (ngo·∫°i tr·ª´ ti·∫øng Vi·ªát, s·ªë, d·∫•u c√¢u)\r",
									"    const specialCharPattern = /[^a-zA-Z0-9\\s.,!?√°√†·∫£√£·∫°ƒÉ·∫Ø·∫±·∫≥·∫µ·∫∑√¢·∫•·∫ß·∫©·∫´·∫≠√©√®·∫ª·∫Ω·∫π√™·∫ø·ªÅ·ªÉ·ªÖ·ªá√≠√¨·ªâƒ©·ªã√≥√≤·ªè√µ·ªç√¥·ªë·ªì·ªï·ªó·ªô∆°·ªõ·ªù·ªü·ª°·ª£√∫√π·ªß≈©·ª•∆∞·ª©·ª´·ª≠·ªØ·ª±√Ω·ª≥·ª∑·ªπ·ªµƒëƒê]/;\r",
									"\r",
									"    // ===== Ki·ªÉm tra bookId =====\r",
									"    if (bookId === \"\" || bookId === null || bookId === \"abc\") {\r",
									"        pm.test(\"‚ùå bookId kh√¥ng h·ª£p l·ªá (r·ªóng/null/abc)\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (typeof bookId === \"string\" && specialCharPattern.test(bookId)) {\r",
									"        pm.test(\"‚ùå bookId ch·ª©a k√Ω t·ª± ƒë·∫∑c bi·ªát kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect.fail(`bookId ch·ª©a k√Ω t·ª± kh√¥ng h·ª£p l·ªá: \"${bookId}\"`);\r",
									"        });\r",
									"    }\r",
									"\r",
									"    // ===== Ki·ªÉm tra userId =====\r",
									"    if (userId === \"\" || userId === null || userId === \"abc\") {\r",
									"        pm.test(\"‚ùå userId kh√¥ng h·ª£p l·ªá (r·ªóng/null/abc)\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"    }\r",
									"\r",
									"    if (typeof userId === \"string\" && specialCharPattern.test(userId)) {\r",
									"        pm.test(\"‚ùå userId ch·ª©a k√Ω t·ª± ƒë·∫∑c bi·ªát kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect.fail(`userId ch·ª©a k√Ω t·ª± kh√¥ng h·ª£p l·ªá: \"${userId}\"`);\r",
									"        });\r",
									"    }\r",
									"\r",
									"    // ===== Ki·ªÉm tra rating =====\r",
									"    if (rating === \"\" || rating === null || isNaN(rating) || rating < 1 || rating > 5) {\r",
									"        pm.test(\"‚ùå rating kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"    }\r",
									"\r",
									"    // ===== Ki·ªÉm tra comment =====\r",
									"    if (typeof comment !== \"string\" || comment === \"\") {\r",
									"        pm.test(\"‚ùå comment kh√¥ng h·ª£p l·ªá (r·ªóng ho·∫∑c kh√¥ng ph·∫£i string)\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"    } else if (specialCharPattern.test(comment)) {\r",
									"        pm.test(\"‚ùå comment ch·ª©a k√Ω t·ª± ƒë·∫∑c bi·ªát kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect.fail(`Comment ch·ª©a k√Ω t·ª± kh√¥ng h·ª£p l·ªá: \"${comment}\"`);\r",
									"        });\r",
									"    }\r",
									"}\r",
									"    // ==== 401 - Unauthorized ====\r",
									"    if (statusCode === 401) {\r",
									"        pm.test(\" 401 - Kh√¥ng x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"            pm.expect(true).to.be.true;\r",
									"            console.warn(\" Ki·ªÉm tra l·∫°i token ho·∫∑c ph√¢n quy·ªÅn\");\r",
									"        });\r",
									"    }\r",
									"\r",
									"    // ==== 404 - Not Found ====\r",
									"    if (statusCode === 404) {\r",
									"        pm.test(\" 404 - Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu\", () => {\r",
									"            pm.expect(msg).to.match(/not found|kh√¥ng t√¨m th·∫•y/);\r",
									"        });\r",
									"\r",
									"        const notFoundBookIds = JSON.parse(pm.environment.get(\"notFoundBookIds\") || \"[]\");\r",
									"        const notFoundUserIds = JSON.parse(pm.environment.get(\"notFoundUserIds\") || \"[]\");\r",
									"\r",
									"        if (notFoundBookIds.includes(reviewBody.bookId) || notFoundUserIds.includes(reviewBody.userId)) {\r",
									"            pm.test(\" bookId ho·∫∑c userId kh√¥ng t·ªìn t·∫°i\", () => {\r",
									"                pm.expect(true).to.be.true;\r",
									"            });\r",
									"        }\r",
									"    }\r",
									"\r",
									"    // ==== 500 - Server Error ====\r",
									"    if (statusCode === 500) {\r",
									"        pm.test(\" 500 - L·ªói server n·ªôi b·ªô\", () => {\r",
									"            pm.expect(msg).to.match(/l·ªói|error|exception|server/i);\r",
									"        });\r",
									"    }\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{user_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{reviewBody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"reviews"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Auth",
			"item": [
				{
					"name": "Update password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"console.log(` Th·ªùi gian ph·∫£n h·ªìi: ${pm.response.responseTime} ms`);\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA HEADER AUTHORIZATION\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"// === Ki·ªÉm tra token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200 ===\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\"‚ùå Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"// === Test: Authorization h·ª£p l·ªá ===\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"// PARSE JSON RESPONSE\r",
									"// ===============================\r",
									"let json = {};\r",
									"let parseError = false;\r",
									"\r",
									"try {\r",
									"    json = pm.response.json();\r",
									"} catch (e) {\r",
									"    parseError = true;\r",
									"    console.error(\"‚ùå Kh√¥ng parse ƒë∆∞·ª£c JSON response\");\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  L·∫§Y TH√îNG TIN T·ª™ RESPONSE\r",
									"// ===============================\r",
									"const newPassword = json.password || \"\";\r",
									"const oldPassword = pm.environment.get(\"oldPassword\") || \"\";\r",
									"const userId = pm.request.url.path.slice(-1)[0] || json.id || \"\";\r",
									"const isUserIdValid = userId && /^\\d+$/.test(userId);\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA THEO STATUS CODE\r",
									"// ===============================\r",
									"switch (statusCode) {\r",
									"    case 200:\r",
									"        pm.test(\" Status 200 - Th√†nh c√¥ng\", () => {\r",
									"            pm.expect(statusCode).to.eql(200);\r",
									"        });\r",
									"\r",
									"        // Ki·ªÉm tra Content-Type\r",
									"        pm.test(\" Content-Type l√† JSON\", () => {\r",
									"            const contentType = pm.response.headers.get(\"Content-Type\");\r",
									"            pm.expect(contentType).to.include(\"application/json\");\r",
									"        });\r",
									"\r",
									"        // userId h·ª£p l·ªá\r",
									"        pm.test(\" userId h·ª£p l·ªá (s·ªë nguy√™n d∆∞∆°ng)\", () => {\r",
									"            pm.expect(isUserIdValid, `‚ùå userId kh√¥ng h·ª£p l·ªá: ${userId}`).to.be.true;\r",
									"        });\r",
									"\r",
									"        // M·∫≠t kh·∫©u ƒë·ªß m·∫°nh\r",
									"        pm.test(\" M·∫≠t kh·∫©u m·∫°nh\", () => {\r",
									"            pm.expect(newPassword.length >= 8, \"‚ùå M·∫≠t kh·∫©u < 8 k√Ω t·ª±\").to.be.true;\r",
									"            pm.expect(/[!@#$%^&*(),.?\":{}|<>]/.test(newPassword), \"‚ùå M·∫≠t kh·∫©u thi·∫øu k√Ω t·ª± ƒë·∫∑c bi·ªát\").to.be.true;\r",
									"        });\r",
									"\r",
									"        // So s√°nh m·∫≠t kh·∫©u m·ªõi v√† c≈©\r",
									"        if (oldPassword) {\r",
									"            pm.test(\" M·∫≠t kh·∫©u m·ªõi kh√°c m·∫≠t kh·∫©u c≈©\", () => {\r",
									"                pm.expect(newPassword, \"‚ùå M·∫≠t kh·∫©u m·ªõi tr√πng m·∫≠t kh·∫©u c≈©\").to.not.eql(oldPassword);\r",
									"            });\r",
									"        }\r",
									"\r",
									"        // Ki·ªÉm tra tr·∫°ng th√°i t√†i kho·∫£n\r",
									"        pm.test(\"T√†i kho·∫£n kh√¥ng b·ªã kh√≥a\", () => {\r",
									"            pm.expect(json.status, \"‚ùå T√†i kho·∫£n ƒëang b·ªã t·∫°m kh√≥a\").to.not.eql(\"unactive\");\r",
									"        });\r",
									"\r",
									"        break;\r",
									"\r",
									"    case 400:\r",
									"        pm.test(\" Status 400 - D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá\", () => {\r",
									"            pm.expect(statusCode).to.eql(400);\r",
									"        });\r",
									"\r",
									"        // Debug c√°c l·ªói ti·ªÅm ·∫©n\r",
									"        if (!isUserIdValid) {\r",
									"            console.error(\" L·ªói: userId kh√¥ng h·ª£p l·ªá.\");\r",
									"        }\r",
									"\r",
									"        if (newPassword === oldPassword) {\r",
									"            console.error(\" L·ªói: M·∫≠t kh·∫©u m·ªõi tr√πng v·ªõi m·∫≠t kh·∫©u c≈©.\");\r",
									"        }\r",
									"\r",
									"        if (newPassword.length < 8 || !/[!@#$%^&*(),.?\":{}|<>]/.test(newPassword)) {\r",
									"            console.error(\"L·ªói: M·∫≠t kh·∫©u y·∫øu.\");\r",
									"        }\r",
									"\r",
									"        break;\r",
									"\r",
									"    case 401:\r",
									"        pm.test(\" 401 - Ch∆∞a x√°c th·ª±c ho·∫∑c kh√¥ng c√≥ quy·ªÅn\", () => {\r",
									"            pm.expect(true).to.be.true;\r",
									"        });\r",
									"        console.warn(\" C·∫ßn ki·ªÉm tra l·∫°i token ho·∫∑c quy·ªÅn truy c·∫≠p\");\r",
									"        break;\r",
									"\r",
									"    case 403:\r",
									"        pm.test(\" 403 - Kh√¥ng ƒë·ªß quy·ªÅn\", () => {\r",
									"            pm.expect(statusCode).to.eql(403);\r",
									"        });\r",
									"        console.warn(\" B·∫°n kh√¥ng c√≥ quy·ªÅn th·ª±c hi·ªán h√†nh ƒë·ªông n√†y.\");\r",
									"        break;\r",
									"            case 404:\r",
									"        pm.test(\" 404 - Kh√¥ng t√¨m th·∫•y ng∆∞·ªùi d√πng\", () => {\r",
									"            pm.expect(statusCode).to.eql(404);\r",
									"        });\r",
									"\r",
									"        // Ki·ªÉm tra n·∫øu userId null ho·∫∑c kh√¥ng h·ª£p l·ªá\r",
									"        if (!isUserIdValid) {\r",
									"            console.warn(\"  userId kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng t·ªìn t·∫°i.\");\r",
									"        }\r",
									"\r",
									"        // C√≥ th·ªÉ ki·ªÉm tra th√™m message t·ª´ response\r",
									"       if (!parseError && json.message) {\r",
									"    const message = json.message.toLowerCase();\r",
									"    const validKeywords = [\"not found\", \"missing\", \"invalid\", \"error\", \"kh√¥ng t√¨m th·∫•y\", \"kh√¥ng t·ªìn t·∫°i\"];\r",
									"\r",
									"    const hasMatch = validKeywords.some(keyword => message.includes(keyword));\r",
									"\r",
									"    pm.test(\" Message ph·∫£n h·ªìi ch·ª©a t·ª´ kh√≥a h·ª£p l·ªá\", () => {\r",
									"        pm.expect(hasMatch).to.be.true;\r",
									"    });\r",
									"}\r",
									"\r",
									"\r",
									"    case 500:\r",
									"        pm.test(\" 500 - L·ªói ph√≠a server\", () => {\r",
									"            pm.expect(true).to.be.true;\r",
									"        });\r",
									"        console.warn(\" C√≥ l·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"        break;\r",
									"\r",
									"    default:\r",
									"        pm.test(` Status code kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω: ${statusCode}`, () => {\r",
									"            pm.expect([200, 400, 401, 403, 500]).to.include(statusCode);\r",
									"        });\r",
									"        console.warn(` Tr·∫°ng th√°i kh√¥ng n·∫±m trong danh s√°ch ki·ªÉm tra: ${statusCode}`);\r",
									"        break;\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA TH·ªúI GIAN PH·∫¢N H·ªíI\r",
									"// ===============================\r",
									"const maxResponseTime = 1000;\r",
									"pm.test(\" Ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"    pm.expect(pm.response.responseTime).to.be.below(maxResponseTime);\r",
									"});\r",
									"\r",
									"// ===============================\r",
									"//  LOG DEBUG\r",
									"// ===============================\r",
									"console.log(\" userId:\", userId);\r",
									"console.log(\" newPassword:\", newPassword);\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra userId ƒë√∫ng\r",
									"// pm.environment.set(\"userId\", \"1\");\r",
									"// //Ki·ªÉm tra userId null\r",
									"//pm.environment.set(\"userId\", \"null\");\r",
									"// //Ki·ªÉm tra userId r·ªóng\r",
									"//pm.environment.set(\"userId\", \"\");\r",
									"// //Ki·ªÉm tra userId kh√¥ng t√¥ng t·∫°i\r",
									"//pm.environment.set(\"userId\", \"999\");\r",
									"// //Ki·ªÉm tra userId sai ƒë·ªãnh d·∫°ng\r",
									"//pm.environment.set(\"userId\", \"abc\");\r",
									"// //Ki·ªÉm tra userId gi√° tr·ªã √¢m\r",
									"// pm.environment.set(\"userId\", \"-1\");\r",
									"// //Ki·ªÉm tra userId k√Ω t·ª± ƒë·∫∑c bi·ªát\r",
									"//pm.environment.set(\"userId\", \"@\");\r",
									"//Ki·ªÉm tra password ƒë√∫ng\r",
									"pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"    \"password\": \"password123@@\" // \r",
									"}));\r",
									"// //Ki·ªÉm tra password null\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"password\": null\r",
									"// }));\r",
									"// //Ki·ªÉm tra password r·ªóng\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"password\": \"\"\r",
									"// }));\r",
									"// // //Ki·ªÉm tra password tr√πng l·∫∑p\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"password\": \"password123@\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra password kh√¥ng ƒë·ªß k√Ω t·ª±(8 k√Ω t·ª± )\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"password\": \"pas1@\"\r",
									"// }));\r",
									"// //Ki·ªÉm tra password thi·∫øu k√≠ t·ª± ƒë·∫∑c bi·ªát\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"password\": \"password123\"\r",
									"// }));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{{passwordBody}}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/users/{{userId}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"{{userId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login_user",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION HEADER\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\" Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA PH·∫¢N H·ªíI D·ªÆ LI·ªÜU\r",
									"// ===============================\r",
									"let jsonData = {};\r",
									"try {\r",
									"    jsonData = pm.response.json();\r",
									"} catch (e) {\r",
									"    console.warn(\" Kh√¥ng th·ªÉ parse JSON t·ª´ ph·∫£n h·ªìi.\");\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  G√ÅN TOKEN SAU KHI LOGIN TH√ÄNH C√îNG\r",
									"// ===============================\r",
									"if (statusCode === 200 && jsonData.access_token) {\r",
									"    const role = jsonData?.user?.role;\r",
									"\r",
									"    pm.environment.set(\"token\", jsonData.access_token); // bi·∫øn d√πng chung cho c√°c request\r",
									"\r",
									"    if (role === \"admin\") {\r",
									"        pm.environment.set(\"admin_token\", jsonData.access_token);\r",
									"    } else if (role === \"user\") {\r",
									"        pm.environment.set(\"user_token\", jsonData.access_token);\r",
									"    }\r",
									"\r",
									"    console.log(`‚úÖ Token ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o bi·∫øn m√¥i tr∆∞·ªùng (${role}_token)`);\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA THEO M√É TR·∫†NG TH√ÅI\r",
									"// ===============================\r",
									"switch (statusCode) {\r",
									"    case 200:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i l√† 200\", () => {\r",
									"            pm.response.to.have.status(200);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Content-Type bao g·ªìm application/json\", () => {\r",
									"            pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\r",
									"        });\r",
									"\r",
									"        pm.test(\" Th·ªùi gian ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"            pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a access_token v√† th√¥ng tin ng∆∞·ªùi d√πng\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"access_token\");\r",
									"            pm.expect(jsonData).to.have.property(\"user\");\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 400:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 400 - Thi·∫øu ho·∫∑c sai ƒë·ªãnh d·∫°ng\", () => {\r",
									"            pm.response.to.have.status(400);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói x√°c th·ª±c\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.satisfy(msg =>\r",
									"                msg.includes(\"username\") || msg.includes(\"password\")\r",
									"            );\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 401:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 401 - Ch∆∞a x√°c th·ª±c ho·∫∑c sai token\", () => {\r",
									"            pm.response.to.have.status(401);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói ƒëƒÉng nh·∫≠p th·∫•t b·∫°i\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.include(\"login failed\");\r",
									"        });\r",
									"\r",
									"        console.warn(\" Token sai ho·∫∑c kh√¥ng c√≥ quy·ªÅn. Ki·ªÉm tra l·∫°i x√°c th·ª±c.\");\r",
									"        break;\r",
									"\r",
									"    case 403:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 403 - B·ªã t·ª´ ch·ªëi quy·ªÅn truy c·∫≠p\", () => {\r",
									"            pm.response.to.have.status(403);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói quy·ªÅn truy c·∫≠p\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.match(/access denied|kh√¥ng ƒë∆∞·ª£c ph√©p/i);\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 500:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 500 - L·ªói ph√≠a server\", () => {\r",
									"            pm.response.to.have.status(500);\r",
									"        });\r",
									"\r",
									"        console.warn(\" L·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"        break;\r",
									"\r",
									"    default:\r",
									"        pm.test(` Kh√¥ng x·ª≠ l√Ω c·ª• th·ªÉ cho m√£ tr·∫°ng th√°i ${statusCode}`, () => {\r",
									"            pm.expect(statusCode).to.be.oneOf([200, 400, 401, 403, 500]);\r",
									"        });\r",
									"        break;\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// // //Ki·ªÉm tra password, user ƒë√∫ng\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//    \"username\": \"ly123\", \"password\": \"abcdefg@h\" \r",
									"// }));\r",
									"// // //Ki·ªÉm tra password, user kh√¥ng ƒë√∫ng\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"ly1231\", \"password\": \"abcdefg@h\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra user ƒë√∫ng password sai\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"username\": \"ly123\", \"password\": \"wrongpassword\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra user r·ªïng\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"username\": \"\", \"password\": \"abcdefg@h\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra password r·ªóng\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"username\": \"ly123\", \"password\": \"\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra user v√† password r·ªóng\r",
									"// pm.environment.set(\"passwordBody\", JSON.stringify({\r",
									"//     \"username\": \"\", \"password\": \"\"\r",
									"// }));\r",
									"\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{user_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/login_user",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"login_user"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login_admin",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const statusCode = pm.response.code;\r",
									"\r",
									"// ===============================\r",
									"// KI·ªÇM TRA AUTHORIZATION HEADER\r",
									"// ===============================\r",
									"const authHeader = pm.request.headers.find(h => h.key.toLowerCase() === 'authorization')?.value || '';\r",
									"const token = authHeader.replace('Bearer ', '').trim();\r",
									"\r",
									"const looksInvalidToken =\r",
									"    !authHeader ||\r",
									"    !authHeader.startsWith(\"Bearer \") ||\r",
									"    token.length < 10 ||\r",
									"    /(fake|test|invalid|null|NaN)/i.test(token);\r",
									"\r",
									"const fakeTokenWhitelist = [\r",
									"    \"fake-admin-token-999\",\r",
									"    \"fake-user-token-123\"\r",
									"];\r",
									"const isWhitelistedFake = fakeTokenWhitelist.includes(token);\r",
									"\r",
									"pm.test(\" Header Authorization t·ªìn t·∫°i v√† h·ª£p l·ªá\", () => {\r",
									"    pm.expect(authHeader).to.include(\"Bearer \");\r",
									"    pm.expect(token.length).to.be.greaterThan(10);\r",
									"});\r",
									"\r",
									"if (looksInvalidToken && statusCode === 200 && !isWhitelistedFake) {\r",
									"    pm.test(\" Token kh√¥ng h·ª£p l·ªá nh∆∞ng v·∫´n tr·∫£ v·ªÅ 200\", () => {\r",
									"        pm.expect.fail(`Token \"${token}\" kh√¥ng h·ª£p l·ªá nh∆∞ng API v·∫´n tr·∫£ v·ªÅ 200`);\r",
									"    });\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA PH·∫¢N H·ªíI D·ªÆ LI·ªÜU\r",
									"// ===============================\r",
									"let jsonData = {};\r",
									"try {\r",
									"    jsonData = pm.response.json();\r",
									"} catch (e) {\r",
									"    console.warn(\" Kh√¥ng th·ªÉ parse JSON t·ª´ ph·∫£n h·ªìi.\");\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  G√ÅN TOKEN SAU KHI LOGIN TH√ÄNH C√îNG\r",
									"// ===============================\r",
									"if (statusCode === 200 && jsonData.access_token) {\r",
									"    const role = jsonData?.user?.role;\r",
									"\r",
									"    pm.environment.set(\"token\", jsonData.access_token); // bi·∫øn d√πng chung cho c√°c request\r",
									"\r",
									"    if (role === \"admin\") {\r",
									"        pm.environment.set(\"admin_token\", jsonData.access_token);\r",
									"    } else if (role === \"user\") {\r",
									"        pm.environment.set(\"user_token\", jsonData.access_token);\r",
									"    }\r",
									"\r",
									"    console.log(`‚úÖ Token ƒë√£ ƒë∆∞·ª£c l∆∞u v√†o bi·∫øn m√¥i tr∆∞·ªùng (${role}_token)`);\r",
									"}\r",
									"\r",
									"// ===============================\r",
									"//  KI·ªÇM TRA THEO M√É TR·∫†NG TH√ÅI\r",
									"// ===============================\r",
									"switch (statusCode) {\r",
									"    case 200:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i l√† 200\", () => {\r",
									"            pm.response.to.have.status(200);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Content-Type bao g·ªìm application/json\", () => {\r",
									"            pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\r",
									"        });\r",
									"\r",
									"        pm.test(\" Th·ªùi gian ph·∫£n h·ªìi < 1000ms\", () => {\r",
									"            pm.expect(pm.response.responseTime).to.be.below(1000);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a access_token v√† th√¥ng tin ng∆∞·ªùi d√πng\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"access_token\");\r",
									"            pm.expect(jsonData).to.have.property(\"user\");\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 400:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 400 - Thi·∫øu ho·∫∑c sai ƒë·ªãnh d·∫°ng\", () => {\r",
									"            pm.response.to.have.status(400);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói x√°c th·ª±c\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.satisfy(msg =>\r",
									"                msg.includes(\"username\") || msg.includes(\"password\")\r",
									"            );\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 401:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 401 - Ch∆∞a x√°c th·ª±c ho·∫∑c sai token\", () => {\r",
									"            pm.response.to.have.status(401);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói ƒëƒÉng nh·∫≠p th·∫•t b·∫°i\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.include(\"login failed\");\r",
									"        });\r",
									"\r",
									"        console.warn(\" Token sai ho·∫∑c kh√¥ng c√≥ quy·ªÅn. Ki·ªÉm tra l·∫°i x√°c th·ª±c.\");\r",
									"        break;\r",
									"\r",
									"    case 403:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 403 - B·ªã t·ª´ ch·ªëi quy·ªÅn truy c·∫≠p\", () => {\r",
									"            pm.response.to.have.status(403);\r",
									"        });\r",
									"\r",
									"        pm.test(\" Ph·∫£n h·ªìi ch·ª©a th√¥ng b√°o l·ªói quy·ªÅn truy c·∫≠p\", () => {\r",
									"            pm.expect(jsonData).to.have.property(\"message\");\r",
									"            pm.expect(jsonData.message.toLowerCase()).to.match(/access denied|kh√¥ng ƒë∆∞·ª£c ph√©p/i);\r",
									"        });\r",
									"        break;\r",
									"\r",
									"    case 500:\r",
									"        pm.test(\" M√£ tr·∫°ng th√°i 500 - L·ªói ph√≠a server\", () => {\r",
									"            pm.response.to.have.status(500);\r",
									"        });\r",
									"\r",
									"        console.warn(\" L·ªói ph√≠a backend (logic ho·∫∑c server)\");\r",
									"        break;\r",
									"\r",
									"    default:\r",
									"        pm.test(` Kh√¥ng x·ª≠ l√Ω c·ª• th·ªÉ cho m√£ tr·∫°ng th√°i ${statusCode}`, () => {\r",
									"            pm.expect(statusCode).to.be.oneOf([200, 400, 401, 403, 500]);\r",
									"        });\r",
									"        break;\r",
									"}\r",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// //Ki·ªÉm tra password, user ƒë√∫ng\r",
									"pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"  \"username\": \"admin\",\r",
									"  \"password\": \"asvjdfk@a\"\r",
									"}));\r",
									"// //  Ki·ªÉm Tra Password  sai\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"admin\",\r",
									"//     \"password\": \"asvjdfkb\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra user sai\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"admin123\",\r",
									"//     \"password\": \"asvjdfk@a\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra password r·ªóng\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"admin\",\r",
									"//     \"password\": \"\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra user r·ªóng\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"\",\r",
									"//     \"password\": \"asvjdfk@a\"\r",
									"// }));\r",
									"// // Ki·ªÉm tra password v√† user r·ªóng\r",
									"// pm.environment.set(\"passwordBody_Admin\", JSON.stringify({\r",
									"//     \"username\": \"\",\r",
									"//     \"password\": \"\"\r",
									"// }));"
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{ \"username\": \"admin\", \"password\": \"asvjdfk@a\" }",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/login_admin",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"login_admin"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}